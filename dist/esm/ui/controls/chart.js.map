{"version":3,"file":"chart.js","sources":["../../../../src/ui/controls/chart.ts"],"sourcesContent":["import { VrControl } from \"../common\";\nimport { ChartAreaSettings, ChartDataLabelAlignEnum, ChartDataLabelsAnchorEnum, ChartDataLabelsSettings, ChartLegendSettings, ChartTitleSettings, ChartTooltipSettings, ChartTypeEnum, ControlTypeEnum, ChartFont, ChartAspectRatioSettings, ChartOptions, ChartAxisFormatterEvent, ChartLegendClickEvent, ChartLegendLeaveEvent, ChartLegendHoverEvent, ChartLabelClickEvent, ChartLabelLeaveEvent, ChartLabelHoverEvent, ChartDataSource, puma } from \"../vr\";\n\ndeclare var Chart: any;\ndeclare var ChartDataLabels: any;\n\n//#region Control\nexport class ChartVr extends VrControl\n{\n\tprivate _chart: any;\n\tprivate _plugins: ChartPlugin;\n\tprivate _datasource: ChartDataSource[];\n\n\tconstructor(element: HTMLElement, options?: ChartOptions | null)\n\t{\n\t\t//#region Options\n\t\tif (options == null)\n\t\t\toptions = new ChartOptions();\n\n\t\tif (options.width == null) options.width = 400;\n\t\tif (options.height == null) options.height = 400;\n\t\tif (options.type == null) options.type = ChartTypeEnum.Bar;\n\t\tif (options.padding == null) options.padding = 0;\n\t\tif (options.showHideDatasetOnLegendClick == null) options.showHideDatasetOnLegendClick = true;\n\t\tif (options.responsive == null) options.responsive = true;\n\n\t\tif (options.stacked == null) options.stacked = false;\n\t\tif (options.type == ChartTypeEnum.StackedBar && options.stacked === false) options.stacked = true;\n\t\tif (options.stacked === true) options.stacked = { x: true, y: true };\n\n\t\tif (options.title == null) options.title = false;\n\t\tif (options.title === true) options.title = new ChartTitleSettings();\n\t\tif (options.subTitle == null) options.subTitle = false;\n\t\tif (options.subTitle === true) options.subTitle = new ChartTitleSettings();\n\n\t\tif (options.dataLabels == null) options.dataLabels = true;\n\t\tif (options.dataLabels === true) options.dataLabels = new ChartDataLabelsSettings();\n\n\t\tif (options.legend == null) options.legend = false;\n\t\tif (options.legend === true) options.legend = new ChartLegendSettings();\n\n\t\tif (options.tooltip == null) options.tooltip = true;\n\t\tif (options.tooltip === true) options.tooltip = new ChartTooltipSettings();\n\t\t//#endregion\n\n\t\tsuper(element, options, ControlTypeEnum.Chart);\n\t\tthis._plugins = new ChartPlugin();\n\n\t\t//#region Title\n\t\tlet title: any = undefined;\n\t\tif (options.title !== false)\n\t\t{\n\t\t\tif (typeof (options.title) == \"string\")\n\t\t\t{\n\t\t\t\tlet text = options.title;\n\t\t\t\toptions.title = new ChartTitleSettings();\n\t\t\t\toptions.title.text = text;\n\t\t\t}\n\n\t\t\t(options.title as any).display = true;\n\t\t\tif (options.title.color == null) options.title.color = \"#51B3E1\";\n\t\t\tif (options.title.font == null) options.title.font = new ChartFont();\n\t\t\tif (options.title.font.size == null) options.title.font.size = 16;\n\t\t\ttitle = options.title;\n\t\t}\n\t\tthis._plugins.title = title;\n\t\t//#endregion\n\n\t\t//#region SubTitle\n\t\tlet subTitle: any = undefined;\n\t\tif (options.subTitle !== false)\n\t\t{\n\t\t\tif (typeof (options.subTitle) == \"string\")\n\t\t\t{\n\t\t\t\tlet text = options.subTitle;\n\t\t\t\toptions.subTitle = new ChartTitleSettings();\n\t\t\t\toptions.subTitle.text = text;\n\t\t\t}\n\n\t\t\t(options.subTitle as any).display = true;\n\t\t\tif (options.subTitle.color == null) options.subTitle.color = \"#666666\";\n\t\t\tsubTitle = options.subTitle;\n\t\t}\n\t\tthis._plugins.subtitle = subTitle;\n\t\t//#endregion\n\n\t\t//#region Data labels\n\t\tlet dataLabels: any = undefined;\n\t\tif (options.dataLabels !== false)\n\t\t{\n\t\t\tif (options.dataLabels.color == null) options.dataLabels.color = \"#666666\";\n\t\t\tif (options.dataLabels.anchor == null) options.dataLabels.anchor = ChartDataLabelsAnchorEnum.End;\n\t\t\tif (options.dataLabels.align == null) options.dataLabels.align = ChartDataLabelAlignEnum.End;\n\t\t\tif (options.dataLabels.padding == null) options.dataLabels.padding = { left: 5, right: 5 };\n\t\t\tdataLabels = options.dataLabels;\n\n\t\t\tif (options.onDataFormatter != null)\n\t\t\t{\n\t\t\t\tdataLabels.formatter = (value: any, context: any) => \n\t\t\t\t{\n\t\t\t\t\tlet axisFormatterEvent = new ChartAxisFormatterEvent();\n\t\t\t\t\taxisFormatterEvent.sender = this;\n\t\t\t\t\taxisFormatterEvent.value = value;\n\t\t\t\t\taxisFormatterEvent.context = context;\n\t\t\t\t\treturn options!.onDataFormatter!(axisFormatterEvent);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tdataLabels.listeners = {\n\t\t\t\tenter: (context: any) =>\n\t\t\t\t{\n\t\t\t\t\tcontext.hovered = true;\n\t\t\t\t\tif (options!.onLabelHover != null)\n\t\t\t\t\t{\n\t\t\t\t\t\tlet hoverEvent = new ChartLabelHoverEvent();\n\t\t\t\t\t\thoverEvent.sender = this;\n\t\t\t\t\t\thoverEvent.context = context;\n\t\t\t\t\t\toptions!.onLabelHover(hoverEvent);\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t},\n\t\t\t\tleave: (context: any) =>\n\t\t\t\t{\n\t\t\t\t\tcontext.hovered = false;\n\t\t\t\t\tif (options!.onLabelLeave != null)\n\t\t\t\t\t{\n\t\t\t\t\t\tlet leaveEvent = new ChartLabelLeaveEvent();\n\t\t\t\t\t\tleaveEvent.sender = this;\n\t\t\t\t\t\tleaveEvent.context = context;\n\t\t\t\t\t\toptions!.onLabelLeave(leaveEvent);\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t},\n\t\t\t\tclick: (context: any) =>\n\t\t\t\t{\n\t\t\t\t\tif (options!.onLabelClick != null)\n\t\t\t\t\t{\n\t\t\t\t\t\tlet clickEvent = new ChartLabelClickEvent();\n\t\t\t\t\t\tclickEvent.sender = this;\n\t\t\t\t\t\tclickEvent.context = context;\n\t\t\t\t\t\toptions!.onLabelClick(clickEvent);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\t\tdataLabels = { display: false };\n\n\t\tthis._plugins.datalabels = dataLabels;\n\t\t//#endregion\n\n\t\t//#region Tooltip\n\t\tlet tooltip: any = { enabled: false };\n\t\tif (options.tooltip !== false)\n\t\t{\n\t\t\t(options.tooltip as any).enabled = true;\n\t\t\ttooltip = options.tooltip;\n\t\t}\n\t\tthis._plugins.tooltip = tooltip;\n\t\t//#endregion\n\n\t\t//#region Legend\n\t\tlet legend: any = { display: false };\n\t\tif (options.legend !== false)\n\t\t{\n\t\t\tlegend = {\n\t\t\t\tdisplay: true,\n\t\t\t\tposition: options.legend.position,\n\t\t\t\talign: options.legend.align,\n\t\t\t\tlabels: options.legend.labels,\n\t\t\t\ttitle: options.legend.title,\n\t\t\t\tonHover: (e: any, legendItem: any, legend: any) =>\n\t\t\t\t{\n\t\t\t\t\tif (options!.onLegendHover != null)\n\t\t\t\t\t{\n\t\t\t\t\t\tlet hoverEvent = new ChartLegendHoverEvent();\n\t\t\t\t\t\thoverEvent.sender = this;\n\t\t\t\t\t\thoverEvent.event = e;\n\t\t\t\t\t\thoverEvent.legendItem = legendItem;\n\t\t\t\t\t\thoverEvent.legend = legend;\n\t\t\t\t\t\toptions!.onLegendHover(hoverEvent);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonLeave: (e: any, legendItem: any, legend: any) =>\n\t\t\t\t{\n\t\t\t\t\tif (options!.onLegendLeave != null)\n\t\t\t\t\t{\n\t\t\t\t\t\tlet leaveEvent = new ChartLegendLeaveEvent();\n\t\t\t\t\t\tleaveEvent.sender = this;\n\t\t\t\t\t\tleaveEvent.event = e;\n\t\t\t\t\t\tleaveEvent.legendItem = legendItem;\n\t\t\t\t\t\tleaveEvent.legend = legend;\n\t\t\t\t\t\toptions!.onLegendLeave(leaveEvent);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonClick: (e: any, legendItem: any, legend: any) =>\n\t\t\t\t{\n\t\t\t\t\tif (options!.showHideDatasetOnLegendClick)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (legend.chart.config.type === ChartTypeEnum.Pie || legend.chart.config.type === ChartTypeEnum.Donut)\n\t\t\t\t\t\t\tChart.controllers.doughnut.overrides.plugins.legend.onClick(e, legendItem, legend)\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tChart.defaults.plugins.legend.onClick(e, legendItem, legend);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (options!.onLegendClick != null)\n\t\t\t\t\t{\n\t\t\t\t\t\tlet clickEvent = new ChartLegendClickEvent();\n\t\t\t\t\t\tclickEvent.sender = this;\n\t\t\t\t\t\tclickEvent.event = e;\n\t\t\t\t\t\tclickEvent.legendItem = legendItem;\n\t\t\t\t\t\tclickEvent.legend = legend;\n\t\t\t\t\t\toptions!.onLegendClick(clickEvent);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis._plugins.legend = legend;\n\t\t//#endregion\n\n\t\t//#region Scales\n\t\tif (options.scales == null) options.scales = {};\n\t\tif (options.scales.x == null) options.scales.x = {};\n\t\toptions.scales.x.grace = \"5%\";\n\t\tif (options.scales.y == null) options.scales.y = {};\n\t\toptions.scales.y.grace = \"5%\";\n\n\t\tif (options.type == ChartTypeEnum.Pie || options.type == ChartTypeEnum.Donut)\n\t\t{\n\t\t\toptions.scales.x.display = false;\n\t\t\toptions.scales.y.display = false;\n\t\t}\n\n\t\tif (options.stacked !== false)\n\t\t{\n\t\t\toptions.scales.x.stacked = options.stacked.x;\n\t\t\toptions.scales.y.stacked = options.stacked.y;\n\t\t}\n\n\t\tif (options.onAxisLabelFormatter != null)\n\t\t{\n\t\t\tlet callback = (value: any, context: any) => \n\t\t\t{\n\t\t\t\tlet axisFormatterEvent = new ChartAxisFormatterEvent();\n\t\t\t\taxisFormatterEvent.sender = this;\n\t\t\t\taxisFormatterEvent.value = value;\n\t\t\t\taxisFormatterEvent.context = context;\n\t\t\t\treturn options!.onAxisLabelFormatter!(axisFormatterEvent);\n\t\t\t};\n\n\t\t\tif (options.type == ChartTypeEnum.HorizontalBar)\n\t\t\t{\n\t\t\t\toptions.scales.x.ticks = {\n\t\t\t\t\tcallback: callback\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\toptions.scales.y.ticks = {\n\t\t\t\t\tcallback: callback\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (options.limit != null)\n\t\t{\n\t\t\toptions.scales.x.min = options.limit.minX;\n\t\t\toptions.scales.x.max = options.limit.maxX;\n\t\t\toptions.scales.y.min = options.limit.minY;\n\t\t\toptions.scales.y.max = options.limit.maxY;\n\t\t}\n\t\t//#endregion\n\n\t\t//#region Aspect ratio\n\t\tif (options.aspectRatio == null) options.aspectRatio = new ChartAspectRatioSettings();\n\t\tif (options.aspectRatio.maintain == null) options.aspectRatio.maintain = false;\n\t\t//#endregion\n\n\t\t//#region Data\n\t\tif (options.datasource == null) options.datasource = [];\n\t\tthis.datasource(options.datasource);\n\t\t//#endregion\n\t}\n\n\t//#region Methods\n\tbase64Data()\n\t{\n\t\treturn (this.element() as HTMLCanvasElement).toDataURL().replace(\"data:image/png;base64,\", \"\");\n\t}\n\n\tdatasource(datasource?: ChartDataSource[])\n\t{\n\t\tif (this._chart != null)\n\t\t\tthis._chart.destroy();\n\n\t\tlet options = this.getOptions();\n\t\tlet labels: string[] = [];\n\n\t\tif (datasource != null)\n\t\t{\n\t\t\tfor (let dataset of datasource)\n\t\t\t{\n\t\t\t\t//#region Area settings\n\t\t\t\tif (options.type == ChartTypeEnum.Area || dataset.type == ChartTypeEnum.Area)\n\t\t\t\t{\n\t\t\t\t\tif (dataset.areaSettings == null) dataset.areaSettings = new ChartAreaSettings();\n\t\t\t\t\tif (dataset.areaSettings.target == null) dataset.areaSettings.target = \"origin\";\n\t\t\t\t\tif (dataset.areaSettings.above == null) dataset.areaSettings.above = \"rgba(255, 99, 132, 0.2)\";\n\t\t\t\t\tif (dataset.areaSettings.below == null) dataset.areaSettings.below = \"rgba(255, 159, 64, 0.2)\";\n\t\t\t\t\t(dataset as any).fill = dataset.areaSettings;\n\t\t\t\t}\n\t\t\t\t//#endregion\n\t\t\t\telse if (options.type == ChartTypeEnum.Line)\n\t\t\t\t{\n\t\t\t\t\tif (dataset.smoothLine == null) dataset.smoothLine = true;\n\t\t\t\t\tif (dataset.smoothLine) (dataset as any).tension = 0.4;\n\t\t\t\t}\n\n\t\t\t\tif (dataset.borderWidth == null) dataset.borderWidth = 1;\n\t\t\t\tif (dataset.title != null)\n\t\t\t\t\t(dataset as any).label = dataset.title;\n\n\t\t\t\tif (dataset.labels != null)\n\t\t\t\t\tlabels.vrPushRange(dataset.labels);\n\t\t\t}\n\n\t\t\tthis._datasource = datasource;\n\t\t\tlet chartData = { labels: labels, datasets: datasource };\n\t\t\tthis.createChart(chartData);\n\t\t}\n\t\treturn this._datasource;\n\t}\n\n\tprivate createChart(chartData: any)\n\t{\n\t\tlet options = this.getOptions();\n\t\tlet type = (options.type == ChartTypeEnum.HorizontalBar || options.type == ChartTypeEnum.StackedBar) ? ChartTypeEnum.Bar : options.type;\n\t\tif (options.type == ChartTypeEnum.Area) type = ChartTypeEnum.Line;\n\n\t\tlet config = {\n\t\t\ttype: type,\n\t\t\tdata: chartData,\n\t\t\toptions: {\n\t\t\t\tresponsive: options.responsive,\n\t\t\t\tmaintainAspectRatio: options.aspectRatio!.maintain,\n\t\t\t\taspectRatio: options.aspectRatio!.value,\n\t\t\t\tcircumference: options.circumference,\n\t\t\t\trotation: options.rotation,\n\t\t\t\tscales: options.scales,\n\t\t\t\tparsing: options.parsing,\n\t\t\t\tplugins: {\n\t\t\t\t\tdatalabels: this._plugins.datalabels,\n\t\t\t\t\ttitle: this._plugins.title,\n\t\t\t\t\tsubtitle: this._plugins.subtitle,\n\t\t\t\t\tlegend: this._plugins.legend,\n\t\t\t\t\ttooltip: this._plugins.tooltip,\n\t\t\t\t\tannotation: options.annotation\n\t\t\t\t},\n\t\t\t\tindexAxis: (options.type == ChartTypeEnum.HorizontalBar) ? \"y\" : \"x\",\n\t\t\t},\n\t\t\tlayout: { padding: options.padding },\n\t\t\tplugins: [ChartDataLabels]\n\t\t};\n\t\tthis._chart = new Chart(this.element(), config);\n\t}\n\n\tgetOptions()\n\t{\n\t\treturn this.options<ChartOptions>();\n\t}\n\t//#endregion\n}\n\nexport class BarChart extends ChartVr { }\nexport class HorizontalBarChart extends ChartVr { }\nexport class LineChart extends ChartVr { }\nexport class DonutChart extends ChartVr { }\nexport class PieChart extends ChartVr { }\nexport class AreaChart extends ChartVr { }\nexport class StackedBarChart extends ChartVr { }\n//#endregion\n\n//#region Classes\nclass ChartPlugin\n{\n\tdatalabels: any;\n\ttitle: any;\n\tsubtitle: any;\n\tlegend: any;\n\ttooltip: any;\n}\n//#endregion"],"names":["legend"],"mappings":"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"}