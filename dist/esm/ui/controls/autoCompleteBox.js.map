{"version":3,"file":"autoCompleteBox.js","sources":["../../../../src/ui/controls/autoCompleteBox.ts"],"sourcesContent":["import { UtilityManager } from \"../../../src/managers/utilityManager\";\nimport { VrControlOptions, VrControl, VrControlsEvent } from \"../common\";\nimport { AutoCompleteBoxItem, ControlTypeEnum, createTextBox, div, span, puma, createIcon, IconClassicLight, IconClass, AutoCompleteBoxComboSettings, AutoCompleteBoxItemSettings, WebApiModeEnum, ComboBoxItem, ComboBoxTreeModeEnum, KeyEnum, shadowRoot, IconClassicRegular } from \"../vr\";\nimport { TextBox } from \"./textbox\";\n\n//#region Options\nexport class AutoCompleteBoxOptions extends VrControlOptions\n{\n\tvalue?: string[] | AutoCompleteBoxItem[];\n\trows?: number;\n\tplaceholder?: string;\n\tborder?: boolean;\n\titemSettings?: AutoCompleteBoxItemSettings;\n\tcomboSettings?: AutoCompleteBoxComboSettings;\n\ttooltip?: boolean;\n\n\tonItemClick?: (e: AutoCompleteBoxItemClickEvent) => void;\n\tonItemAdded?: (e: AutoCompleteBoxItemAddedEvent) => void;\n\tonItemRemoved?: (e: AutoCompleteBoxItemRemovedEvent) => void;\n\tonFocus?: (e: AutoCompleteBoxFocusEvent) => void;\n\tonBlur?: (e: AutoCompleteBoxBlurEvent) => void;\n}\n//#endregion\n\n//#region Control\nexport class AutoCompleteBox extends VrControl\n{\n\t//#region Variables\n\tprivate _txtInput: TextBox;\n\tprivate _spanForWidth: HTMLElement;\n\tprivate _items: AutoCompleteBoxItem[];\n\n\tprivate _comboItems: ComboBoxItem[];\n\tprivate _popup: HTMLElement;\n\tprivate _lastAjaxCallGuid: string;\n\tprivate _typedTextWebService: string | null;\n\tprivate _dictionaryValueLi: Map<string, HTMLElement[]>;\n\tprivate _dictionaryLiValue: Map<HTMLElement, string>;\n\t//#endregion\n\n\tconstructor(element: HTMLElement, options?: AutoCompleteBoxOptions | null)\n\t{\n\t\t//#region Options\n\t\tif (options == null)\n\t\t\toptions = new AutoCompleteBoxOptions();\n\n\t\tif (options.width == null) options.width = 300;\n\t\tif (options.border == null) options.border = true;\n\t\tif (options.tooltip == null) options.tooltip = true;\n\n\t\tif (options.itemSettings == null) options.itemSettings = new AutoCompleteBoxItemSettings();\n\t\tif (options.itemSettings.backgroundColor == null) options.itemSettings.backgroundColor = \"#FFF\";\n\t\tif (options.itemSettings.textColor == null) options.itemSettings.textColor = \"#5f6368\";\n\t\tif (options.itemSettings.border == null) options.itemSettings.border = \"solid 1px #dadce0\";\n\t\tif (options.itemSettings.bold == null) options.itemSettings.bold = false;\n\t\tif (options.itemSettings.deleteIconColor == null) options.itemSettings.deleteIconColor = \"rgb(140 140 140)\";\n\n\t\tif (options.comboSettings != null)\n\t\t{\n\t\t\tif (options.comboSettings.freeText == null) options.comboSettings.freeText = true;\n\t\t\tif (options.comboSettings.treeMode == null) options.comboSettings.treeMode = ComboBoxTreeModeEnum.AllExpanded;\n\t\t}\n\t\t//#endregion\n\n\t\tsuper(element, options, ControlTypeEnum.AutoCompleteBox);\n\t\tpuma(this.element()).attr(\"tabindex\", \"1\");\n\t\tthis._spanForWidth = span(this.element(), { css: \"visibility: hidden;\" });\n\n\t\tthis._popup = puma(\"<div class='comboBox_divPopup vrPopup' id='\" + element.id + \"_divPopup' style='border: solid 1px #ccc; display: none; position: absolute;  border-radius: 4px; box-shadow: 0 5px 10px rgb(0 0 0 / 20%); padding: 5px; overflow-y: auto; z-index: 9999999;  background-color: #fff; height: fit-content;'></div>\").vrAppendToPuma((shadowRoot() != null) ? shadowRoot() : document.body)[0];\n\n\t\tthis._items = [];\n\n\t\tif (options.border)\n\t\t\tthis.element().style.cssText += \"border: solid 1px #ccc;\";\n\n\t\tlet timeout = 0;\n\t\tthis._txtInput = createTextBox({\n\t\t\tcssContainer: \"width: auto !important;\",\n\t\t\tcss: \"width: 20px; min-width: 20px !important; max-width: \" + this.width() + \"px; padding-left: 0px; padding-right: 0px;\",\n\t\t\tonKeyUp: (e) =>\n\t\t\t{\n\t\t\t\t//#region Ctrl+V (paste support)\n\t\t\t\tif (e.key == KeyEnum.ArrowRight || e.key == KeyEnum.ArrowLeft || e.key == KeyEnum.ArrowUp\n\t\t\t\t\t|| e.key == KeyEnum.Control || e.ctrlKey)\n\t\t\t\t{\n\t\t\t\t\tif (!(e.key == \"v\" && e.ctrlKey))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.manageInputWidth();\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t//#endregion\n\n\t\t\t\tif (options!.comboSettings != null)\n\t\t\t\t{\n\t\t\t\t\tclearTimeout(timeout);\n\t\t\t\t\ttimeout = window.setTimeout(() =>\n\t\t\t\t\t{\n\t\t\t\t\t\tlet text = String(e.value);\n\t\t\t\t\t\tif (options!.comboSettings == null || options!.comboSettings.webService == null)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t//#region Items\n\t\t\t\t\t\t\tlet filteredItems = this.filter(text, this.element());\n\t\t\t\t\t\t\tif (filteredItems.length > 0)\n\t\t\t\t\t\t\t\tthis.open();\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\tthis.close();\n\n\t\t\t\t\t\t\tif (e.key == \"v\" && e.ctrlKey && filteredItems.length == 1)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.valueCombo(String(filteredItems[0].value));\n\t\t\t\t\t\t\t\tthis.close();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t//#endregion\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (options!.comboSettings.webService != null)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t//#region WebService\n\t\t\t\t\t\t\tif (e.key != KeyEnum.Enter)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif (text == \"\")\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tthis._items = [];\n\t\t\t\t\t\t\t\t\tpuma(this._popup).find(\"ul\").remove();\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tlet selectionStart = (this.element() as HTMLInputElement).selectionStart;\n\t\t\t\t\t\t\t\t\tlet selectionEnd = (this.element() as HTMLInputElement).selectionEnd;\n\t\t\t\t\t\t\t\t\tif (!(selectionStart == 0 && selectionEnd == (this.element() as HTMLInputElement).value.length))\n\t\t\t\t\t\t\t\t\t\tthis.doAjaxCall(text);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t//#endregion\n\t\t\t\t\t\t}\n\t\t\t\t\t}, 300);\n\t\t\t\t}\n\t\t\t},\n\t\t\tonEnterKey: (e) => \n\t\t\t{\n\t\t\t\tif (options!.comboSettings != null)\n\t\t\t\t{\n\t\t\t\t\tif (options!.comboSettings.freeText)\n\t\t\t\t\t\tthis.manageInput(e.sender, e.sender.value<string>());\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis._txtInput.clear();\n\t\t\t\t\t\tthis.placeholder(options!.placeholder);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t\tthis.manageInput(e.sender, e.sender.value<string>());\n\t\t\t},\n\t\t\tonKeyDown: (e) => \n\t\t\t{\n\t\t\t\tthis.manageInputWidth()\n\n\t\t\t\tif (options!.comboSettings != null && e.key == KeyEnum.ArrowDown)\n\t\t\t\t{\n\t\t\t\t\tlet li = puma(this._popup).find(\"li:visible\").first();\n\t\t\t\t\tli.focus();\n\t\t\t\t}\n\t\t\t},\n\t\t\tonBlur: (e) =>\n\t\t\t{\n\t\t\t\tif (this._txtInput.value() != \"\" && !$(this._popup).is(\":visible\"))\n\t\t\t\t{\n\t\t\t\t\tthis.manageInput(this._txtInput, this._txtInput.value())\n\t\t\t\t\tthis.blurEvent();\n\t\t\t\t}\n\t\t\t}\n\t\t}, this.element())\n\n\t\tif (options.comboSettings != null && options.comboSettings.items != null)\n\t\t\tthis.comboItems(options.comboSettings.items);\n\n\t\t//#region Focus\n\t\tpuma(this.element()).on(\"focus\", (e: JQuery.FocusEvent) => this.focus());\n\t\t//#endregion\n\n\t\t//#region Value & Placeholder\n\t\tif (options.placeholder != null)\n\t\t\tthis.placeholder(options.placeholder);\n\n\t\tif (options.value != null)\n\t\t\tthis.items(options.value);\n\t\t//#endregion\n\n\t\t//#region Rows\n\t\tif (options.rows != null)\n\t\t{\n\t\t\tlet maxHeight = 0;\n\t\t\tfor (let i = 0; i < options.rows; i++)\n\t\t\t{\n\t\t\t\tif (i == 0) maxHeight += 27;\n\t\t\t\telse maxHeight += 22;\n\t\t\t}\n\t\t\tthis.element().style.cssText += \"max-height: \" + maxHeight + \"px;\";\n\t\t}\n\t\t//#endregion\n\n\t\tlet baseListener = (shadowRoot() != null) ? shadowRoot() : document;\n\t\tbaseListener!.addEventListener(\"scroll\", (e) =>\n\t\t{\n\t\t\tif (!puma(e.target).hasClass(\"comboBox_divPopup\") && puma(this._popup).is(\":visible\"))\n\t\t\t\tthis.close();\n\t\t}, true);\n\t}\n\n\t//#region ManageInput\n\tprivate manageInput(sender: any, text: string, value?: string | null)\n\t{\n\t\tlet options = this.getOptions();\n\t\tsender.clear();\n\t\tthis.placeholder(options.placeholder);\n\n\t\tif (text != \"\")\n\t\t{\n\t\t\tfor (let txt of text.split(\",\"))\n\t\t\t{\n\t\t\t\tlet item = new AutoCompleteBoxItem();\n\t\t\t\titem.text = txt.trim();\n\t\t\t\tif (value != null) item.value = value;\n\t\t\t\tthis.addItem(item);\n\t\t\t}\n\t\t}\n\n\t\t// Reposition input at the end\n\t\tpuma(this._txtInput.container()).vrAppendToPuma(this.element());\n\n\t\twindow.setTimeout(() => this.focus());\n\t\tthis.close();\n\t}\n\n\tprivate manageInputWidth()\n\t{\n\t\tlet options = this.getOptions();\n\t\tlet value = this._txtInput.value<string>();\n\t\tif (value != \"\")\n\t\t\tthis._txtInput.element().style.width = (this.textWidth(value) + 20) + \"px\";\n\t\telse\n\t\t\tthis.placeholder(options.placeholder);\n\t}\n\t//#endregion\n\n\t//#region Items\n\titems(items?: string[] | AutoCompleteBoxItem[])\n\t{\n\t\tif (items != null)\n\t\t{\n\t\t\tfor (let item of items)\n\t\t\t\tthis.addItem(item);\n\t\t}\n\t\treturn this._items;\n\t}\n\n\taddItem(item: string | AutoCompleteBoxItem)\n\t{\n\t\tif (item == null || item == \"\")\n\t\t\treturn;\n\n\t\tlet options = this.getOptions();\n\t\tthis.placeholder(\"\");\n\n\t\tlet realItem: AutoCompleteBoxItem = item as any;\n\t\tif (typeof (item) == \"string\")\n\t\t{\n\t\t\trealItem = new AutoCompleteBoxItem();\n\t\t\trealItem.text = item;\n\t\t\trealItem.value = item;\n\t\t}\n\n\t\tif (realItem.value == null)\n\t\t\trealItem.value = realItem.text;\n\n\t\tlet divItem = div(this.element(), { class: \"vrAutoCompleteBoxItem\", attributes: [{ name: \"value\", value: realItem.value }] });\n\t\tlet spanItemText = span(divItem, { content: realItem.text, class: \"vrAutoCompleteBoxItemText\" });\n\n\t\t//#region Tooltip\n\t\tif (options.tooltip)\n\t\t\tpuma(divItem).attr(\"title\", realItem.text);\n\t\t//#endregion\n\n\t\t//#region Color\n\t\tlet backgroundColor = options.itemSettings!.backgroundColor!;\n\t\tlet textColor = options.itemSettings!.textColor!;\n\t\tlet border = options.itemSettings!.border!;\n\t\tlet bold = options.itemSettings!.bold!;\n\t\tlet deleteIconColor = options.itemSettings!.deleteIconColor!;\n\t\tlet maxWidth = options.itemSettings!.maxWidth;\n\n\t\tif (realItem.settings != null)\n\t\t{\n\t\t\tif (realItem.settings.backgroundColor != null) backgroundColor = realItem.settings.backgroundColor;\n\t\t\tif (realItem.settings.textColor != null) textColor = realItem.settings.textColor;\n\t\t\tif (realItem.settings.border != null) border = realItem.settings.border;\n\t\t\tif (realItem.settings.bold != null) bold = realItem.settings.bold;\n\t\t\tif (realItem.settings.deleteIconColor != null) deleteIconColor = realItem.settings.deleteIconColor;\n\t\t\tif (realItem.settings.maxWidth != null) maxWidth = realItem.settings.maxWidth;\n\t\t}\n\n\t\tdivItem.style.cssText += \"background-color: \" + backgroundColor + \"; color: \" + textColor + \"; border: \" + border + \";\";\n\t\tif (bold)\n\t\t\tdivItem.style.cssText += \"font-weight: 600;\";\n\n\t\tif (maxWidth != null)\n\t\t\tspanItemText.style.cssText += \"max-width: \" + maxWidth + \"px;\";\n\t\t//#endregion\n\n\t\t//#region Click to edit\n\t\tpuma(divItem).on(\"click\", (e: JQuery.ClickEvent) =>\n\t\t{\n\t\t\t//#region ItemClick event\n\t\t\tif (options!.onItemClick != null)\n\t\t\t{\n\t\t\t\tlet itemClickEvent = new AutoCompleteBoxItemClickEvent();\n\t\t\t\titemClickEvent.sender = this;\n\t\t\t\titemClickEvent.item = { item: realItem, element: divItem };\n\t\t\t\titemClickEvent.text = realItem.text;\n\t\t\t\toptions!.onItemClick(itemClickEvent);\n\n\t\t\t\tif (itemClickEvent.isDefaultPrevented())\n\t\t\t\t{\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\t//#endregion\n\n\t\t\t// Position input at the current item position\n\t\t\tpuma(this._txtInput.container()).vrInsertBeforePuma(divItem);\n\n\t\t\tthis.removeItem(realItem.value!);\n\n\t\t\t//#region Input value & width\n\t\t\tlet width = this.textWidth(realItem.text);\n\n\t\t\tthis._txtInput.value(realItem.text, false);\n\t\t\tthis._txtInput.element().style.width = (width + 20) + \"px\";\n\t\t\t(this._txtInput.element() as HTMLInputElement).select();\n\t\t\t//#endregion\n\n\t\t\tthis.focus();\n\t\t});\n\t\t//#endregion\n\n\t\t//#region Delete\n\t\tcreateIcon({\n\t\t\tvalue: IconClassicRegular.Xmark,\n\t\t\tcssContainer: \"margin-left: 5px; top: -1px;\",\n\t\t\tcolor: deleteIconColor,\n\t\t\tonClick: (e) => this.removeItem(realItem.value!)\n\t\t}, divItem);\n\t\t//#endregion\n\n\t\tpuma(divItem).vrInsertBeforePuma(this._txtInput.container())\n\n\t\tif (realItem.value != null)\n\t\t\tpuma(divItem).attr(\"value\", realItem.value);\n\n\t\tthis._items.push(realItem);\n\n\t\t//#region Item added event\n\t\tif (options!.onItemAdded != null)\n\t\t{\n\t\t\tlet itemAddedEvent = new AutoCompleteBoxItemAddedEvent();\n\t\t\titemAddedEvent.sender = this;\n\t\t\titemAddedEvent.item = { item: realItem, element: divItem };\n\t\t\toptions!.onItemAdded(itemAddedEvent);\n\t\t}\n\t\t//#endregion\n\t}\n\n\tremoveItem(value: string)\n\t{\n\t\tthis._items.vrDeleteAllBy(k => k.value == value);\n\t\tpuma(this.container()).find(\".vrAutoCompleteBoxItem[value='\" + value + \"']\").remove();\n\n\t\tlet options = this.getOptions();\n\t\tif (this.items().length == 0)\n\t\t\tthis.placeholder(options.placeholder);\n\n\t\t//#region Item removed event\n\t\tif (options!.onItemRemoved != null)\n\t\t{\n\t\t\tlet itemAddedEvent = new AutoCompleteBoxItemAddedEvent();\n\t\t\titemAddedEvent.sender = this;\n\t\t\titemAddedEvent.item = this.item(value);\n\t\t\toptions!.onItemRemoved(itemAddedEvent);\n\t\t}\n\t\t//#endregion\n\t}\n\n\titem(value: string)\n\t{\n\t\tlet item = new AutoCompleteBoxItemInfo();\n\n\t\tlet realItem = this._items.filter(k => k.value == value)[0];\n\t\tlet index = this.items().indexOf(realItem);\n\t\titem.item = this.items()[index];\n\n\t\titem.element = puma(this.container()).find(\".vrAutoCompleteBoxItem[value='\" + value + \"']\")[0];\n\t\treturn item;\n\t}\n\t//#endregion\n\n\t//#region Color\n\tcolor(value: string, settings: AutoCompleteBoxItemSettings)\n\t{\n\t\tlet item = this.item(value);\n\t\tif (item.element != null && settings != null)\n\t\t{\n\t\t\tif (settings.backgroundColor != null) item.element.style.cssText += \"background-color: \" + settings.backgroundColor + \";\";\n\t\t\tif (settings.textColor != null) item.element.style.cssText += \"color: \" + settings.textColor + \";\";\n\t\t\tif (settings.border != null) item.element.style.cssText += \"border: \" + settings.border + \";\";\n\t\t\tif (settings.bold) item.element.style.cssText += \"font-weight: 600;\";\n\t\t}\n\t}\n\t//#endregion\n\n\t//#region Value\n\ttext()\n\t{\n\t\treturn this.items().map(k => k.text);\n\t}\n\n\tvalue(items?: string[] | AutoCompleteBoxItem[])\n\t{\n\t\tif (items != null)\n\t\t\tthis.items(items);\n\n\t\treturn this.items().map(k => k.value);\n\t}\n\n\tplaceholder(value?: string): string\n\t{\n\t\tif (value != null)\n\t\t{\n\t\t\tlet width = this.textWidth(value);\n\t\t\t(this._txtInput.element() as HTMLInputElement).placeholder = value;\n\t\t\tthis._txtInput.element().style.width = (width + 20) + \"px\";\n\t\t}\n\t\treturn (this._txtInput.element() as HTMLInputElement).placeholder;\n\t}\n\t//#endregion\n\n\t//#region Other\n\tprivate textWidth(value: string)\n\t{\n\t\tlet width = 0;\n\t\tthis._spanForWidth.innerHTML = value.replace(/\\s/g, \"&nbsp;\");\n\t\twidth = this._spanForWidth.offsetWidth;\n\t\tthis._spanForWidth.innerHTML = \"\";\n\n\t\treturn width;\n\t}\n\n\tfocus()\n\t{\n\t\tlet options = this.getOptions();\n\t\tif (!puma(this.element()).vrHasScrollBar())\n\t\t{\n\t\t\tthis._txtInput.focus();\n\t\t\tthis.focusEvent();\n\n\t\t\tif (this._txtInput.value() == \"\")\n\t\t\t\tthis.placeholder(options.placeholder);\n\t\t}\n\t}\n\n\tprivate focusEvent()\n\t{\n\t\tlet options = this.getOptions();\n\t\tif (options.onFocus != null)\n\t\t{\n\t\t\tlet focusEvent = new AutoCompleteBoxFocusEvent();\n\t\t\tfocusEvent.sender = this;\n\t\t\tfocusEvent.element = this._txtInput.element();\n\t\t\toptions.onFocus(focusEvent);\n\t\t}\n\t}\n\n\tprivate blurEvent()\n\t{\n\t\tlet options = this.getOptions();\n\t\tif (options.onBlur != null)\n\t\t{\n\t\t\tlet focusEvent = new AutoCompleteBoxBlurEvent();\n\t\t\tfocusEvent.sender = this;\n\t\t\tfocusEvent.element = this._txtInput.element();\n\t\t\toptions.onBlur(focusEvent);\n\t\t}\n\t}\n\n\tclear()\n\t{\n\t\tlet options = this.getOptions();\n\t\tthis._items = [];\n\n\t\tpuma(this.container()).find(\".vrAutoCompleteBoxItem\").remove();\n\t\tthis._txtInput.clear();\n\n\t\tthis.placeholder(options.placeholder);\n\t}\n\t//#endregion\n\n\t//#region Popup webservice\n\tprivate close(): void\n\t{\n\t\tpuma(this._popup).hide();\n\t}\n\n\tprivate open(): void\n\t{\n\t\tpuma(this._popup).find(\".vrComboBoxSelectedComboValue\").removeClass(\"vrComboBoxSelectedComboValue\");\n\t\tif (!this.enabled())\n\t\t\treturn;\n\n\t\tif (puma(this._popup).is(\":visible\"))\n\t\t\treturn;\n\n\t\tpuma(this._popup).show();\n\t\tsuper.settingPopup(this._popup);\n\n\t\tlet minWidth = puma(this.element()).width();\n\t\tthis._popup.style.cssText += \"min-width: \" + minWidth + \"px;\";\n\t}\n\n\tprivate doAjaxCall(text = \"\"): void\n\t{\n\t\tlet options = this.getOptions();\n\t\tif (options.comboSettings == null || options.comboSettings.webService == null)\n\t\t\treturn;\n\n\t\tif (options.comboSettings.webService.typedTextPropertyName == null) options.comboSettings.webService.typedTextPropertyName = \"text\";\n\t\tif (options.comboSettings.webService.typedValuePropertyName == null) options.comboSettings.webService.typedValuePropertyName = \"value\";\n\t\tif (options.comboSettings.webService.itemsPropertyName == null) options.comboSettings.webService.itemsPropertyName = \"items\";\n\n\t\tlet request: any = {};\n\t\trequest[options.comboSettings.webService.typedTextPropertyName] = text;\n\n\t\tif (options.comboSettings.webService.authKey == null)\n\t\t\toptions.comboSettings.webService.authKey = \"\";\n\n\t\tif (options.comboSettings.webService.parameters != null)\n\t\t{\n\t\t\tlet parameters = options.comboSettings.webService.parameters();\n\t\t\tlet jsonParameters = Object.getOwnPropertyNames(parameters);\n\t\t\tfor (let param of jsonParameters)\n\t\t\t\trequest[param] = parameters[param];\n\t\t}\n\n\t\tthis._lastAjaxCallGuid = UtilityManager.createGuid();\n\t\trequest.guid = this._lastAjaxCallGuid;\n\t\tUtilityManager.doAjaxCall(\n\t\t\t{\n\t\t\t\tmode: WebApiModeEnum.Async,\n\t\t\t\tauthKey: options.comboSettings.webService.authKey,\n\t\t\t\tmethod: options.comboSettings.webService.method,\n\t\t\t\trequest: request\n\t\t\t},\n\t\t\t(response: any) =>\n\t\t\t{\n\t\t\t\tif (this._lastAjaxCallGuid != null && response.guid != null && this._lastAjaxCallGuid != response.guid)\n\t\t\t\t\treturn;\n\n\t\t\t\tthis._typedTextWebService = text;\n\t\t\t\tlet items = response[options!.comboSettings!.webService!.itemsPropertyName!];\n\t\t\t\tthis.comboItems(items);\n\n\t\t\t\tif (items.length > 0)\n\t\t\t\t\tthis.open();\n\t\t\t\telse\n\t\t\t\t\tthis.close();\n\t\t\t}\n\t\t)\n\t}\n\n\tprivate comboItems(items?: ComboBoxItem[])\n\t{\n\t\tlet options = this.getOptions();\n\t\tif (items != null)\n\t\t{\n\t\t\tthis._comboItems = items;\n\n\t\t\tif (this.getRootItems().length == 0)\n\t\t\t\tpuma(this._popup).addClass(\"vrComboBoxFlat\");\n\t\t\telse\n\t\t\t\tpuma(this._popup).removeClass(\"vrComboBoxFlat\");\n\n\t\t\tif (options.comboSettings!.webService == null)\n\t\t\t{\n\t\t\t\tthis.drawDataSource();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (this._typedTextWebService == null) this._items = [];\n\t\t\t\tthis.drawDataSource();\n\t\t\t\tthis._typedTextWebService = null;\n\t\t\t}\n\t\t}\n\t\treturn this._comboItems;\n\t}\n\n\tprivate getOnlyChildrenItems(parentItem: ComboBoxItem): ComboBoxItem[]\n\t{\n\t\treturn this.comboItems().filter(k => k.parentValue != null && k.parentValue == parentItem.value);\n\t}\n\n\tprivate getRootItems(): ComboBoxItem[]\n\t{\n\t\tlet parentItems: ComboBoxItem[] = [];\n\t\tfor (let item of this.comboItems())\n\t\t{\n\t\t\tif (item == null)\n\t\t\t\tcontinue;\n\n\t\t\tlet parentValue = item.parentValue;\n\t\t\twhile (parentValue != null)\n\t\t\t{\n\t\t\t\tlet parentItem = this.comboItems().filter(k => k.value == parentValue)[0];\n\t\t\t\tif (!parentItems.includes(parentItem))\n\t\t\t\t\tparentItems.push(parentItem);\n\n\t\t\t\tparentValue = (parentItem != null) ? parentItem.parentValue : undefined;\n\t\t\t\tif (parentItem != null && parentValue == parentItem.value)\n\t\t\t\t\tparentValue = undefined;\n\t\t\t}\n\t\t}\n\t\treturn parentItems;\n\t}\n\n\tprivate getRootValues(): string[]\n\t{\n\t\treturn this.getRootItems().filter(k => k != null).map(k => String(k.value));\n\t}\n\n\tprivate drawDataSource(searchedText?: string | null): void\n\t{\n\t\tpuma(this._popup).find(\".vrComboBoxUl\").remove();\n\n\t\tlet items = this.comboItems();\n\t\tif (searchedText != null)\n\t\t\titems = this.getFilteredArrayByInputText(searchedText);\n\n\t\tif (items.length == 1 && items[0] == null)\n\t\t\treturn;\n\n\t\tthis._dictionaryValueLi = new Map<string, HTMLElement[]>();\n\t\tthis._dictionaryLiValue = new Map<HTMLElement, string>();\n\t\titems = items.filter(k => k.parentValue == null);\n\t\tthis.drawItems(items, this._popup);\n\t}\n\n\tprivate drawItems(items: ComboBoxItem[], elementToAppend: HTMLElement): void\n\t{\n\t\tlet options = this.getOptions();\n\t\tif (items.length == 0)\n\t\t\treturn;\n\n\t\tlet ul = puma(\"<ul class='vrComboBoxUl'></ul>\").vrAppendToPuma(elementToAppend);\n\t\tfor (let item of items)\n\t\t{\n\t\t\tif (item.value == null)\n\t\t\t\titem.value = item.text;\n\n\t\t\tlet li = puma(\"<li class='vrComboBoxLi' tabindex='-1'></li>\").vrAppendToPuma(ul);\n\t\t\tthis._dictionaryLiValue.set(li[0], String(item.value));\n\t\t\tif (this._dictionaryValueLi.has(String(item.value)))\n\t\t\t{\n\t\t\t\tlet actualLiList = this._dictionaryValueLi.get(String(item.value))!;\n\t\t\t\tactualLiList.push(li[0]);\n\t\t\t\tthis._dictionaryValueLi.set(String(item.value), actualLiList);\n\t\t\t}\n\t\t\telse\n\t\t\t\tthis._dictionaryValueLi.set(String(item.value), [li[0]]);\n\n\t\t\t//#region Key support\n\t\t\tpuma(li).on(\"focusin\", (e: JQuery.FocusEvent) => \n\t\t\t{\n\t\t\t\tpuma(this._popup).find(\".vrComboBoxSelectedComboValue\").removeClass(\"vrComboBoxSelectedComboValue\");\n\t\t\t\tpuma(e.target).addClass(\"vrComboBoxSelectedComboValue keydownFocus\");\n\t\t\t});\n\t\t\tpuma(li).on(\"keydown\", (e: JQuery.KeyDownEvent) =>\n\t\t\t{\n\t\t\t\tif (e.key == KeyEnum.ArrowDown)\n\t\t\t\t{\n\t\t\t\t\tlet next = puma(e.currentTarget).next();\n\t\t\t\t\tif (next.length == 0)\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\tpuma(this._popup).find(\".vrComboBoxSelectedComboValue\").removeClass(\"vrComboBoxSelectedComboValue\");\n\t\t\t\t\twhile (!next.is(\":visible\"))\n\t\t\t\t\t\tnext = puma(next).next();\n\n\t\t\t\t\tnext.focus();\n\t\t\t\t}\n\t\t\t\telse if (e.key == KeyEnum.ArrowUp)\n\t\t\t\t{\n\t\t\t\t\tlet prev = puma(e.currentTarget).prev();\n\t\t\t\t\tif (prev.length == 0)\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\tpuma(this._popup).find(\".vrComboBoxSelectedComboValue\").removeClass(\"vrComboBoxSelectedComboValue\");\n\t\t\t\t\twhile (!prev.is(\":visible\"))\n\t\t\t\t\t\tprev = puma(prev).prev();\n\n\t\t\t\t\tprev.focus();\n\t\t\t\t}\n\t\t\t\telse if (e.key == KeyEnum.Enter)\n\t\t\t\t\tpuma(e.currentTarget).find(\".vrComboBoxItemText\").click();\n\t\t\t});\n\t\t\t//#endregion\n\n\t\t\t//#region Tree mode\n\t\t\tif (options.comboSettings!.treeMode == ComboBoxTreeModeEnum.AllCollapsed)\n\t\t\t{\n\t\t\t\tif (item.parentValue != null)\n\t\t\t\t\tpuma(li).closest(\".vrComboBoxUl\").hide();\n\t\t\t}\n\t\t\telse if (options.comboSettings!.treeMode == ComboBoxTreeModeEnum.OnlyFirstLevelExpanded)\n\t\t\t{\n\t\t\t\tif (puma(li).parents(\".vrComboBoxUl\").length > 2)\n\t\t\t\t\tpuma(li).closest(\".vrComboBoxUl\").hide();\n\t\t\t}\n\t\t\t//#endregion\n\n\t\t\tlet children = this.getOnlyChildrenItems(item);\n\t\t\tif (children.length > 0)\n\t\t\t{\n\t\t\t\t//#region Icon expand/collapse\n\t\t\t\tlet iconClassForDiv = \"\";\n\t\t\t\tlet iconClass = IconClassicLight.CaretRight;\n\t\t\t\tif (options.comboSettings!.treeMode == ComboBoxTreeModeEnum.AllCollapsed)\n\t\t\t\t{\n\t\t\t\t\tif (item.parentValue != null)\n\t\t\t\t\t{\n\t\t\t\t\t\ticonClass = IconClassicLight.CaretRight;\n\t\t\t\t\t\ticonClassForDiv = \"caret-right\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (options.comboSettings!.treeMode == ComboBoxTreeModeEnum.OnlyFirstLevelExpanded)\n\t\t\t\t{\n\t\t\t\t\tif (puma(li).parents(\".vrComboBoxUl\").length == 1)\n\t\t\t\t\t{\n\t\t\t\t\t\ticonClass = IconClassicLight.CaretDown;\n\t\t\t\t\t\ticonClassForDiv = \"caret-down\";\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\ticonClass = IconClassicLight.CaretRight;\n\t\t\t\t\t\ticonClassForDiv = \"caret-right\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\ticonClass = IconClassicLight.CaretDown;\n\t\t\t\t\ticonClassForDiv = \"caret-down\";\n\t\t\t\t}\n\n\t\t\t\tlet divIcon = puma(\"<div class='vrComboBoxDivIconExpand \" + iconClassForDiv + \"'></div>\").vrAppendToPuma(li);\n\t\t\t\tpuma(UtilityManager.createIcon(iconClass)).vrAppendToPuma(divIcon);\n\t\t\t\tpuma(divIcon).click((e: any) =>\n\t\t\t\t{\n\t\t\t\t\tpuma(e.currentTarget).children(\"i\").removeClass(IconClassicLight.CaretRight + \" \" + IconClassicLight.CaretDown);\n\t\t\t\t\tpuma(e.currentTarget).removeClass(\"caret-right caret-down\");\n\n\t\t\t\t\tlet ulChildren = puma(e.currentTarget).siblings(\".vrComboBoxUl\");\n\t\t\t\t\tif (ulChildren.first().is(\":visible\"))\n\t\t\t\t\t{\n\t\t\t\t\t\tulChildren.hide();\n\t\t\t\t\t\tpuma(e.currentTarget).children(\"i\").addClass(IconClassicLight.CaretRight);\n\t\t\t\t\t\tpuma(e.currentTarget).addClass(\"caret-right\");\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tulChildren.show();\n\t\t\t\t\t\tpuma(e.currentTarget).children(\"i\").addClass(IconClassicLight.CaretDown);\n\t\t\t\t\t\tpuma(e.currentTarget).addClass(\"caret-down\");\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t//#endregion\n\t\t\t}\n\n\t\t\tlet comboItem = puma(\"<div class='vrComboBoxDivItemContainer'></div>\").vrAppendToPuma(li);\n\n\t\t\tlet rowText = item.text.replace(/'/g, \"&#39;\");\n\t\t\tif (options.comboSettings != null && options.comboSettings.template != null)\n\t\t\t{\n\t\t\t\tlet templateEvent: any = {};\n\t\t\t\ttemplateEvent.dataItem = item;\n\t\t\t\ttemplateEvent.element = comboItem[0];\n\t\t\t\ttemplateEvent.sender = this;\n\t\t\t\trowText = options.comboSettings.template(templateEvent);\n\t\t\t}\n\n\t\t\tlet comboItemText = puma(\"<span title='\" + item.text + \"' text='\" + item.text.replace(/'/g, \"&#39;\") + \"' class='vrComboBoxItemText'>\" + rowText + \"</span>\").vrAppendToPuma(comboItem);\n\t\t\tpuma(comboItemText).click((e: any) =>\n\t\t\t{\n\t\t\t\tlet value = this._dictionaryLiValue.get(puma(e.currentTarget).closest(\"li\")[0]);\n\t\t\t\tlet item = this.comboItems().filter(k => k.value == value)[0];\n\t\t\t\tif (item != null && !this.getRootValues().includes(String(item.value)))\n\t\t\t\t{\n\t\t\t\t\tthis.valueCombo(String(item.value));\n\t\t\t\t\tthis.close();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t\tUtilityManager.interval(() => puma(this.element()).toggleClass(\"errorInput\"), 200, 800);\n\t\t\t});\n\n\t\t\tif (children.length > 0)\n\t\t\t\tthis.drawItems(this.getOnlyChildrenItems(item), li);\n\t\t}\n\t}\n\n\tprivate valueCombo(value: string | null)\n\t{\n\t\tif (value === null)\n\t\t{\n\t\t\tthis.clear();\n\t\t\treturn;\n\t\t}\n\n\t\tlet comboItemToSelect: ComboBoxItem = this.comboItems().filter(k => k.value == value)[0];\n\t\tthis._txtInput.value(comboItemToSelect.text, false)\n\t\tthis.manageInput(this._txtInput, this._txtInput.value(), String(comboItemToSelect.value))\n\t}\n\n\tprivate filter(text: string, element: HTMLElement)\n\t{\n\t\tlet options = this.getOptions();\n\t\tlet selectionStart = (element as HTMLInputElement).selectionStart;\n\t\tlet selectionEnd = (element as HTMLInputElement).selectionEnd;\n\t\tlet itemsToReturn: ComboBoxItem[] = [];\n\n\t\tif (text == \"\")\n\t\t{\n\t\t\tpuma(this._popup).find(\"li\").show();\n\t\t\tif (options.comboSettings!.webService != null)\n\t\t\t{\n\t\t\t\tthis._items = [];\n\t\t\t\tpuma(this._popup).find(\".vrComboBoxUl\").remove();\n\t\t\t}\n\t\t}\n\t\telse if (!(selectionStart == 0 && selectionEnd == (element as HTMLInputElement).value.length))\n\t\t{\n\t\t\tpuma(this._popup).find(\"li\").hide();\n\n\t\t\tlet items = this.getFilteredArrayByInputText(text);\n\t\t\titemsToReturn = items;\n\n\t\t\tlet values = items.map(k => k.value);\n\t\t\tlet texts = items.map(k => k.text);\n\n\t\t\tfor (let item of items)\n\t\t\t{\n\t\t\t\tlet parentValue = item.parentValue;\n\t\t\t\twhile (parentValue != null)\n\t\t\t\t{\n\t\t\t\t\tlet parentItem = this.comboItems().filter(k => k.value == parentValue)[0];\n\t\t\t\t\tif (!values.includes(parentValue))\n\t\t\t\t\t{\n\t\t\t\t\t\tvalues.push(parentValue);\n\t\t\t\t\t\ttexts.push(parentItem.text);\n\t\t\t\t\t}\n\t\t\t\t\tparentValue = (parentItem != null) ? parentItem.parentValue : undefined;\n\t\t\t\t\tif (parentValue == parentItem.value)\n\t\t\t\t\t\tparentValue = undefined;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor (let comboItemText of Array.from<HTMLSpanElement>(puma(this._popup).find(\".vrComboBoxItemText\")))\n\t\t\t{\n\t\t\t\tif (texts.includes(String(puma(comboItemText).attr(\"text\")).trim()))\n\t\t\t\t{\n\t\t\t\t\tpuma(comboItemText).closest(\".vrComboBoxLi\").show();\n\t\t\t\t\tpuma(comboItemText).closest(\".vrComboBoxLi\").closest(\".vrComboBoxUl\").show();\n\n\t\t\t\t\tpuma(comboItemText).closest(\".vrComboBoxLi\").find(\".vrComboBoxDivIconExpand\").removeClass(\"caret-right caret-down\");\n\t\t\t\t\tpuma(comboItemText).closest(\".vrComboBoxLi\").find(\".vrComboBoxDivIconExpand\").children(\"i\").removeClass(IconClassicLight.CaretRight + \" \" + IconClassicLight.CaretDown);\n\t\t\t\t\tpuma(comboItemText).closest(\".vrComboBoxLi\").find(\".vrComboBoxDivIconExpand\").addClass(\"caret-down\");\n\t\t\t\t\tpuma(comboItemText).closest(\".vrComboBoxLi\").find(\".vrComboBoxDivIconExpand\").children(\"i\").addClass(IconClassicLight.CaretDown);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn itemsToReturn;\n\t}\n\n\tprivate getFilteredArrayByInputText(value: string): ComboBoxItem[]\n\t{\n\t\tvalue = value.toLowerCase();\n\t\tlet filteredArray: ComboBoxItem[] = [];\n\t\tlet arrayWhereSearch = this.comboItems().map(k => String(k.text).toLowerCase());\n\t\tarrayWhereSearch!.forEach((k, index) => \n\t\t{\n\t\t\tif (k.indexOf(value) != -1)\n\t\t\t\tfilteredArray.push(this.comboItems()[index]);\n\t\t});\n\t\treturn filteredArray;\n\t}\n\t//#endregion\n\n\tgetOptions()\n\t{\n\t\treturn this.options<AutoCompleteBoxOptions>();\n\t}\n}\n\n//#region Classes\nclass AutoCompleteBoxEvent extends VrControlsEvent\n{\n\tsender: AutoCompleteBox;\n}\n\nclass AutoCompleteBoxItemClickEvent extends AutoCompleteBoxEvent\n{\n\titem: AutoCompleteBoxItemInfo;\n\ttext: string;\n}\n\nclass AutoCompleteBoxItemAddedEvent extends AutoCompleteBoxEvent\n{\n\titem: AutoCompleteBoxItemInfo;\n}\n\nclass AutoCompleteBoxItemRemovedEvent extends AutoCompleteBoxEvent\n{\n\titem: AutoCompleteBoxItemInfo;\n}\n\nclass AutoCompleteBoxItemInfo\n{\n\titem: AutoCompleteBoxItem;\n\telement: HTMLElement;\n}\n\nclass AutoCompleteBoxFocusEvent extends AutoCompleteBoxEvent\n{\n\telement: HTMLElement;\n}\n\nclass AutoCompleteBoxBlurEvent extends AutoCompleteBoxEvent\n{\n\telement: HTMLElement;\n}\n//#endregion"],"names":["item"],"mappings":"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"}