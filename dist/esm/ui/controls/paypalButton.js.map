{"version":3,"file":"paypalButton.js","sources":["../../../../src/ui/controls/paypalButton.ts"],"sourcesContent":["import { VrControl, VrControlOptions, VrControlsEvent } from \"../common\";\nimport { ControlTypeEnum, hideLoader, NotifierTypeEnum, notify, PaypalStyleColorEnum, PaypalStyleLabelEnum, PaypalStyleLayoutEnum, PaypalStyleShapeEnum, PaypalStyleSizeEnum, puma, showLoader } from \"../vr\";\ndeclare var paypal: any;\n\n//#region Options\nexport class PaypalButtonOptions extends VrControlOptions\n{\n\tsetupUrl?: PaypalSetupUrl;\n\tstyle?: PaypalStyle;\n\tintent?: string;\n\tcreateOrderRequest?: SetupPaymentRequest;\n\tapproveRequest?: ExecutePaymentRequest;\n\tenableStandardCardFields?: boolean;\n\n\tonRendered?: (e: OnPaypalRenderedEvent) => void;\n\tonCancel?: (e: OnPaypalCancelEvent) => void;\n\tonBeforePayment?: (e: OnPaypalBeforePaymentEvent) => void;\n}\n//#endregion\n\n//#region Control\nexport class PaypalButton extends VrControl\n{\n\tconstructor(element: HTMLElement, options?: PaypalButtonOptions | null)\n\t{\n\t\t//#region Options\n\t\tif (options == null)\n\t\t\toptions = new PaypalButtonOptions();\n\n\t\tif (options.style == null) options.style = new PaypalStyle();\n\t\tif (options.style.color == null) options.style.color = PaypalStyleColorEnum.Gold;\n\t\tif (options.style.size == null) options.style.size = PaypalStyleSizeEnum.Responsive;\n\t\tif (options.style.shape == null) options.style.shape = PaypalStyleShapeEnum.Rect;\n\t\tif (options.style.height == null) options.style.height = 30;\n\t\tif (options.style.tagline == null) options.style.tagline = false;\n\t\tif (options.style.fundingicons == null) options.style.fundingicons = true;\n\t\tif (options.style.layout == null) options.style.layout = PaypalStyleLayoutEnum.Horizontal;\n\t\tif (options.enableStandardCardFields == null) options.enableStandardCardFields = true;\n\t\tif (options.intent == null) options.intent = \"CAPTURE\";\n\n\t\tif (options.createOrderRequest == null) options.createOrderRequest = new SetupPaymentRequest();\n\t\tif (options.createOrderRequest.authKey == null) options.createOrderRequest.authKey = \"1D7822D72F5397BEF65D677C89E85\";\n\t\tif (options.createOrderRequest.method == null) options.createOrderRequest.method = \"/api/PaypalWebApi/CreatePayment/\";\n\n\t\tif (options.approveRequest == null) options.approveRequest = new ExecutePaymentRequest();\n\t\tif (options.approveRequest.authKey == null) options.approveRequest.authKey = \"1D7822D72F5397BEF65D677C89E85\";\n\t\tif (options.approveRequest.method == null) options.approveRequest.method = \"/api/PaypalWebApi/ExecutePayment/\";\n\t\t//#endregion\n\n\t\tsuper(element, options, ControlTypeEnum.PaypalButton);\n\n\t\tif (options.setupUrl != null)\n\t\t{\n\t\t\tif (options.setupUrl.clientId == null)\n\t\t\t\tthrow Error(\"PayPal clientId obbligatorio\");\n\n\t\t\tif (options.setupUrl.currency == null) options.setupUrl.currency = \"EUR\";\n\t\t\tif (options.setupUrl.intent == null) options.setupUrl.intent = \"capture\";\n\t\t\tif (options.setupUrl.commit == null) options.setupUrl.commit = false;\n\t\t\tif (options.setupUrl.locale == null) options.setupUrl.locale = \"it_IT\";\n\n\t\t\t(puma as any).getScript(`<script src='https://www.paypal.com/sdk/js?client-id=` + options.setupUrl.clientId\n\t\t\t\t+ `&currency=` + options.setupUrl.currency + `&intent=` + options.setupUrl.intent\n\t\t\t\t+ `&commit=` + options.setupUrl.commit + `&locale=` + options.setupUrl.locale + `'></script>`)\n\t\t\t\t.then(() => this.renderButton());\n\t\t}\n\t\telse\n\t\t\tthis.renderButton();\n\t}\n\n\t//#region Methods\n\tprivate renderButton()\n\t{\n\t\tlet options = this.getOptions();\n\t\tpaypal.Buttons({\n\t\t\tenableStandardCardFields: options!.enableStandardCardFields,\n\t\t\tstyle: options!.style,\n\t\t\tcreateOrder: (data: any, actions: any) =>\n\t\t\t{\n\t\t\t\tshowLoader(options!.createOrderRequest!.loader);\n\n\t\t\t\tif (options!.onBeforePayment != null)\n\t\t\t\t{\n\t\t\t\t\tlet beforePaymentEvent = new OnPaypalBeforePaymentEvent();\n\t\t\t\t\tbeforePaymentEvent.sender = this;\n\t\t\t\t\toptions!.onBeforePayment(beforePaymentEvent);\n\n\t\t\t\t\tif (beforePaymentEvent.isDefaultPrevented())\n\t\t\t\t\t{\n\t\t\t\t\t\thideLoader();\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlet json = this.prepareWebApiCall(options!.createOrderRequest!, PaypalWebApiTypeEnum.CreateOrder);\n\t\t\t\treturn fetch(options!.createOrderRequest!.method!,\n\t\t\t\t\t{\n\t\t\t\t\t\tmethod: \"post\",\n\t\t\t\t\t\theaders: { \"content-type\": \"application/json\" },\n\t\t\t\t\t\tbody: JSON.stringify(json)\n\t\t\t\t\t})\n\t\t\t\t\t.then((res) =>\n\t\t\t\t\t{\n\t\t\t\t\t\tlet json = res.json() as any;\n\t\t\t\t\t\treturn json;\n\t\t\t\t\t})\n\t\t\t\t\t.then((data) =>\n\t\t\t\t\t{\n\t\t\t\t\t\tif (data.token != null && data.token != \"\")\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (options!.createOrderRequest!.successNotificationMessage != null)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif (options!.createOrderRequest!.successNotificationMessage === true)\n\t\t\t\t\t\t\t\t\toptions!.createOrderRequest!.successNotificationMessage = \"Pagamento creato correttamente\";\n\n\t\t\t\t\t\t\t\tif (options!.createOrderRequest!.successNotificationMessage !== false)\n\t\t\t\t\t\t\t\t\tnotify(options!.createOrderRequest!.successNotificationMessage);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (options!.createOrderRequest!.callback != null)\n\t\t\t\t\t\t\t\toptions!.createOrderRequest!.callback(data);\n\n\t\t\t\t\t\t\treturn data.token;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tthis.manageError(options!.createOrderRequest!, PaypalWebApiTypeEnum.SetupError, data);\n\t\t\t\t\t},\n\t\t\t\t\t\t(exception: any) =>\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\thideLoader();\n\t\t\t\t\t\t\tthis.manageError(options!.createOrderRequest!, PaypalWebApiTypeEnum.CreateOrder);\n\t\t\t\t\t\t});\n\t\t\t},\n\t\t\tonApprove: (data: any, actions: any) =>\n\t\t\t{\n\t\t\t\tlet json = this.prepareWebApiCall(options!.approveRequest!, PaypalWebApiTypeEnum.OnApprove, data);\n\t\t\t\tshowLoader(options!.approveRequest!.loader);\n\n\t\t\t\treturn fetch(options!.approveRequest!.method!,\n\t\t\t\t\t{\n\t\t\t\t\t\tmethod: \"post\",\n\t\t\t\t\t\theaders: { \"content-type\": \"application/json\" },\n\t\t\t\t\t\tbody: JSON.stringify(json)\n\t\t\t\t\t})\n\t\t\t\t\t.then((response: any) =>\n\t\t\t\t\t{\n\t\t\t\t\t\thideLoader();\n\t\t\t\t\t\tif (response.ok == true)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (options!.approveRequest!.successNotificationMessage != null)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tif (options!.approveRequest!.successNotificationMessage === true)\n\t\t\t\t\t\t\t\t\toptions!.approveRequest!.successNotificationMessage = \"Pagamento creato correttamente\";\n\n\t\t\t\t\t\t\t\tif (options!.approveRequest!.successNotificationMessage !== false)\n\t\t\t\t\t\t\t\t\tnotify(options!.approveRequest!.successNotificationMessage);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (options!.approveRequest!.callback != null)\n\t\t\t\t\t\t\t\toptions!.approveRequest!.callback(response);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tthis.manageError(options!.createOrderRequest!, PaypalWebApiTypeEnum.OnApprove, response);\n\t\t\t\t\t},\n\t\t\t\t\t\t(exception: any) =>\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\thideLoader();\n\t\t\t\t\t\t\tthis.manageError(options!.createOrderRequest!, PaypalWebApiTypeEnum.OnApprove, exception);\n\t\t\t\t\t\t});\n\t\t\t},\n\t\t\tonCancel: (data: any, actions: any) =>\n\t\t\t{\n\t\t\t\thideLoader();\n\t\t\t\tif (options!.onCancel != null)\n\t\t\t\t{\n\t\t\t\t\tlet cancelEvent = new OnPaypalCancelEvent();\n\t\t\t\t\tcancelEvent.sender = this;\n\t\t\t\t\tcancelEvent.data = data;\n\t\t\t\t\tcancelEvent.actions = actions;\n\t\t\t\t\toptions!.onCancel(cancelEvent);\n\t\t\t\t}\n\t\t\t},\n\t\t\tonError: (data: any) =>\n\t\t\t{\n\t\t\t\thideLoader();\n\t\t\t\tnotify(\"Si è verificato un errore\", { type: NotifierTypeEnum.Error });\n\t\t\t}\n\t\t}).render(this.element()).then(() =>\n\t\t{\n\t\t\tif (options!.onRendered != null)\n\t\t\t{\n\t\t\t\tlet renderedEvent = new OnPaypalRenderedEvent();\n\t\t\t\trenderedEvent.sender = this;\n\t\t\t\toptions!.onRendered(renderedEvent);\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate prepareWebApiCall(request: PaypalWebApiRequest, requestType: PaypalWebApiTypeEnum, data: any = null)\n\t{\n\t\tlet json: any = {};\n\t\tjson.AuthKey = request.authKey;\n\n\t\t//#region Method\n\t\tif (request.method!.startsWith(\"api/\"))\n\t\t\trequest.method = \"/\" + request.method;\n\n\t\tif (!request.method!.endsWith(\"/\"))\n\t\t\trequest.method! = request.method + \"/\";\n\t\t//#endregion\n\n\t\t//#region Type\n\t\tif (requestType == PaypalWebApiTypeEnum.CreateOrder)\n\t\t{\n\t\t\tif ((request as SetupPaymentRequest).cancelUrl != null)\n\t\t\t\tjson[(request as SetupPaymentRequest).cancelUrl!] = (request as SetupPaymentRequest).cancelUrl;\n\n\t\t\tif ((request as SetupPaymentRequest).returnUrl != null)\n\t\t\t\tjson[(request as SetupPaymentRequest).returnUrl!] = (request as SetupPaymentRequest).returnUrl;\n\t\t}\n\t\telse if (requestType == PaypalWebApiTypeEnum.OnApprove && data != null)\n\t\t{\n\t\t\tif ((request as ExecutePaymentRequest).paymentIdPropertyName == null)\n\t\t\t\t(request as ExecutePaymentRequest).paymentIdPropertyName = \"paymentId\";\n\t\t\tjson[(request as ExecutePaymentRequest).paymentIdPropertyName!] = data.paymentID;\n\n\t\t\tif ((request as ExecutePaymentRequest).payerIdPropertyName == null)\n\t\t\t\t(request as ExecutePaymentRequest).payerIdPropertyName = \"payerId\";\n\t\t\tjson[(request as ExecutePaymentRequest).payerIdPropertyName!] = data.payerID;\n\t\t}\n\t\t//#endregion\n\n\t\t//#region Paramaters\n\t\tif (request.otherParameters != null)\n\t\t{\n\t\t\tlet jsonParameters = Object.getOwnPropertyNames(request.otherParameters);\n\t\t\tfor (let param of jsonParameters)\n\t\t\t\tjson[param] = request.otherParameters[param];\n\t\t}\n\n\t\tif (request.parameters != null)\n\t\t{\n\t\t\tlet parameters = request.parameters();\n\t\t\tlet jsonParameters = Object.getOwnPropertyNames(parameters);\n\t\t\tfor (let param of jsonParameters)\n\t\t\t\tjson[param] = parameters[param];\n\t\t}\n\t\t//#endregion\n\n\t\treturn json;\n\t}\n\n\tprivate manageError(request: PaypalWebApiRequest, requestType: PaypalWebApiTypeEnum, data: any = undefined)\n\t{\n\t\tif (request.errorNotificationMessage != null)\n\t\t{\n\t\t\tif (request.errorNotificationMessage === true)\n\t\t\t{\n\t\t\t\tlet error = \"\";\n\t\t\t\tswitch (requestType)\n\t\t\t\t{\n\t\t\t\t\tcase PaypalWebApiTypeEnum.SetupError: error = String(data.Result.Response); break;\n\t\t\t\t\tcase PaypalWebApiTypeEnum.CreateOrder: error = \"Si è verificato un errore nella creazione del pagamento\"; break;\n\t\t\t\t\tcase PaypalWebApiTypeEnum.OnApprove: error = \"Il pagamento della transazione non è andato a buon fine\"; break;\n\t\t\t\t}\n\t\t\t\trequest.errorNotificationMessage = error;\n\t\t\t}\n\n\t\t\tif (request.errorNotificationMessage !== false)\n\t\t\t\tnotify(request.errorNotificationMessage, { type: NotifierTypeEnum.Error });\n\t\t}\n\t\telse if (data != null)\n\t\t{\n\t\t\tif (data.Result.Response != null)\n\t\t\t\tnotify(data.Result.Response, { type: NotifierTypeEnum.Error });\n\t\t\telse\n\t\t\t\tnotify(data.Result.Message, { type: NotifierTypeEnum.Error });\n\t\t}\n\t\telse\n\t\t\tnotify(\"Si è verificato un errore\", { type: NotifierTypeEnum.Error });\n\n\t\tif (request.errorCallback != null)\n\t\t\trequest.errorCallback(data);\n\t}\n\n\tgetOptions()\n\t{\n\t\treturn this.options<PaypalButtonOptions>();\n\t}\n\t//#endregion\n}\n//#endregion\n\n//#region Classes\nclass PaypalSetupUrl\n{\n\tclientId?: string;\n\tlocale?: string;\n\tcurrency?: string;\n\tintent?: string;\n\tcommit?: boolean;\n}\n\nclass PaypalStyle\n{\n\tsize?: PaypalStyleSizeEnum;\n\tcolor?: PaypalStyleColorEnum;\n\tshape?: PaypalStyleShapeEnum;\n\theight?: number;\n\ttagline?: boolean;\n\tlayout?: PaypalStyleLayoutEnum;\n\tfundingicons?: boolean;\n}\n\nclass PaypalWebApiRequest\n{\n\tauthKey?: string;\n\tmethod?: string;\n\tsuccessNotificationMessage?: boolean | string;\n\terrorNotificationMessage?: boolean | string;\n\totherParameters?: any;\n\tloader?: HTMLElement | JQuery | string;\n\n\tcallback?: (response?: any) => void;\n\terrorCallback?: (message?: string) => void;\n\tparameters?: () => any;\n}\n\nclass SetupPaymentRequest extends PaypalWebApiRequest\n{\n\tcancelUrl?: string;\n\treturnUrl?: string;\n}\n\nclass ExecutePaymentRequest extends PaypalWebApiRequest\n{\n\tpaymentIdPropertyName?: string;\n\tpayerIdPropertyName?: string;\n}\n\nenum PaypalWebApiTypeEnum\n{\n\tCreateOrder,\n\tSetupError,\n\tOnApprove\n}\n\nclass OnPaypalCancelEvent extends VrControlsEvent\n{\n\tsender: PaypalButton;\n\tdata: any;\n\tactions: any;\n}\n\nclass OnPaypalBeforePaymentEvent extends VrControlsEvent\n{\n\tsender: PaypalButton;\n}\n\nclass OnPaypalRenderedEvent extends VrControlsEvent\n{\n\tsender: PaypalButton;\n}\n//#endregion"],"names":["json","data"],"mappings":"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"}