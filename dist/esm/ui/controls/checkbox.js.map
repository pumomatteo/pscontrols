{"version":3,"file":"checkbox.js","sources":["../../../../src/ui/controls/checkbox.ts"],"sourcesContent":["import { VrControlOptions, VrControl } from \"../common\";\nimport { ControlTypeEnum, createLabel, CheckboxStateEnum, ErrorPositionEnum, puma } from \"../vr\";\nimport { DeviceManager } from \"../../../src/managers/deviceManager\";\n\n//#region Options\nexport class CheckBoxOptions extends VrControlOptions\n{\n    text?: string;\n    value?: string;\n    threeState?: boolean;\n    checked?: boolean;\n    name?: string;\n    tooltip?: string;\n\n    onCheck?(e: CheckBoxCheckEvent): void;\n}\n//#endregion\n\n//#region Control\nexport class CheckBox extends VrControl\n{\n    constructor(element: HTMLElement, options?: CheckBoxOptions | null)\n    {\n        //#region Options\n        if (options == null)\n            options = new CheckBoxOptions();\n\n        if (options.text == null) options.text = \"\";\n        if (options.checked == null) options.checked = false;\n        if (options.threeState == null) options.threeState = false;\n        //#endregion\n\n        puma(element).attr(\"type\", \"checkbox\");\n\n        let userWidth = options.width;\n        options.width = undefined;\n        super(element, options, ControlTypeEnum.CheckBox);\n\n        if (userWidth != null)\n        {\n            if (typeof (userWidth) == \"number\")\n                userWidth = userWidth + \"px\";\n\n            this.container().style.cssText += \"width: \" + userWidth + \";\";\n        }\n\n        let label = createLabel(\n            {\n                text: options.text,\n                cssContainer: \"position: relative; top: -1px;\",\n                class: \"vrCheckBoxLabel\",\n                width: \"100%\",\n                tooltip: options.tooltip\n            }, this.container());\n        puma(label.element()).attr(\"for\", element.id);\n\n        //#region Value & Name\n        if (options.value == null) options.value = options.text;\n        if (options.value != null)\n            puma(this.element()).attr(\"value\", options.value);\n\n        if (options.name != null)\n            puma(this.element()).attr(\"name\", options.name);\n        //#endregion\n\n        //#region Tooltip\n        if (options.tooltip != null)\n            puma(this.element()).attr(\"title\", options.tooltip);\n        //#endregion\n\n        //#region Checked\n        if (options.checked === true)\n            this.checked(CheckboxStateEnum.Checked, false);\n        else if (options.threeState)\n            this.checked(CheckboxStateEnum.Undefined, false);\n        //#endregion\n\n        //#region Events\n        puma(this.element()).click((e: JQueryEventObject) =>\n        {\n            this.hideError();\n            let checkbox = e.currentTarget as HTMLInputElement;\n            let checked = checkbox.checked;\n\n            let state = null;\n            if (!options!.threeState)\n            {\n                if (checkbox.checked)\n                    state = CheckboxStateEnum.Checked;\n                else\n                    state = CheckboxStateEnum.Unchecked;\n            }\n            else\n            {\n                if (checkbox.checked && !puma(this.element()).hasClass(\"indeterminateVrCheckbox\"))\n                {\n                    puma(this.element()).addClass(\"indeterminateVrCheckbox\");\n                    state = CheckboxStateEnum.Undefined;\n                    e.preventDefault();\n                }\n                else\n                {\n                    puma(this.element()).removeClass(\"indeterminateVrCheckbox\");\n                    state = (checked) ? CheckboxStateEnum.Checked : CheckboxStateEnum.Unchecked;\n                }\n            }\n\n            if (options!.onCheck != null)\n            {\n                let event = new CheckBoxCheckEvent();\n                event.sender = this;\n                event.checked = checked;\n                event.stateEnum = state;\n                event.shiftKey = e.shiftKey;\n                event.ctrlKey = e.ctrlKey;\n                options!.onCheck(event);\n            }\n        });\n        //#endregion\n    }\n\n    //#region Methods\n    checked<T extends boolean | null>(state?: CheckboxStateEnum | boolean, triggerChange = true): T\n    {\n        if (state != null)\n        {\n            this.hideError();\n            let checkedBoolean = true;\n            let checkedState = CheckboxStateEnum.Checked;\n\n            puma(this.element()).removeClass(\"indeterminateVrCheckbox\");\n            if (typeof (state) === \"boolean\")\n            {\n                (this.element() as HTMLInputElement).checked = state;\n                checkedBoolean = state;\n                checkedState = (state) ? CheckboxStateEnum.Checked : CheckboxStateEnum.Unchecked;\n            }\n            else\n            {\n                checkedState = state;\n                if (state == CheckboxStateEnum.Checked)\n                {\n                    (this.element() as HTMLInputElement).checked = true;\n                    checkedBoolean = true;\n                }\n                else\n                {\n                    (this.element() as HTMLInputElement).checked = false;\n                    checkedBoolean = false;\n\n                    if (state == CheckboxStateEnum.Undefined)\n                        puma(this.element()).addClass(\"indeterminateVrCheckbox\");\n                }\n            }\n\n            if (triggerChange)\n            {\n                let options = this.getOptions();\n                if (options!.onCheck != null)\n                {\n                    let event = new CheckBoxCheckEvent();\n                    event.sender = this;\n                    event.checked = checkedBoolean;\n                    event.stateEnum = checkedState;\n                    options!.onCheck(event);\n                }\n            }\n        }\n\n        if (puma(this.element()).hasClass(\"indeterminateVrCheckbox\"))\n            return <T>null;\n        else\n            return <T>(this.element() as HTMLInputElement).checked;\n    }\n\n    check(): void\n    {\n        puma(this.element()).click();\n    }\n\n    text(text?: string): string\n    {\n        if (text != null)\n            puma(this.container()).find(\".vrCheckBoxLabel\").html(text);\n\n        return puma(this.container()).find(\".vrCheckBoxLabel\").html();\n    }\n\n    clear(triggerChange = false): void\n    {\n        let options = this.getOptions();\n        if (options.threeState)\n            this.checked(CheckboxStateEnum.Undefined, triggerChange);\n        else\n            this.checked(false, triggerChange);\n    }\n\n    getOptions(): CheckBoxOptions\n    {\n        return this.options<CheckBoxOptions>();\n    }\n\n    //#region Error management\n    error(text?: string, position?: ErrorPositionEnum, showIcon = false): void\n    {\n        let options = this.options<CheckBoxOptions>();\n        if (position == null) position = ErrorPositionEnum.Right;\n        if (text == null) text = \"\";\n\n        puma(this.element()).addClass(\"vrCheckBoxError\");\n\n        let errorIcon = puma(this.container()).find(\".vrCheckBoxErrorIcon\")[0];\n        if (errorIcon == null && !DeviceManager.isMobile())\n            errorIcon = puma(\"<i class='fa fa-exclamation-triangle vrCheckBoxErrorIcon'></i>\").vrInsertAfterPuma(puma(this.container()).find(\".vrCheckBoxLabel\"))[0];\n\n        if (showIcon)\n            puma(errorIcon).show();\n        else\n            puma(errorIcon).hide();\n\n        //#region Tooltip\n        let spanError = puma(\"<span class='vrCheckBoxErrorTooltip vrErrorTooltip'>\" + text + \"</span>\").vrAppendToPuma(errorIcon);\n        if (position == ErrorPositionEnum.Right)\n            puma(spanError).addClass(\"vrCheckBoxErrorTooltipRight\");\n        else if (position == ErrorPositionEnum.Bottom)\n        {\n            puma(spanError).addClass(\"vrCheckBoxErrorTooltipBottom\");\n            puma(errorIcon).hover(() => puma(spanError)[0].style.cssText += \"left: -\" + ((puma(spanError).outerWidth() / 2) - 7) + \"px;\");\n        }\n        //#endregion\n    }\n\n    hideError(): void\n    {\n        puma(this.element()).removeClass(\"vrCheckBoxError\");\n        puma(this.container()).find(\".vrCheckBoxErrorIcon\").hide();\n        puma(this.container()).find(\".vrCheckBoxErrorTooltip\").hide();\n    }\n    //#endregion\n\n    //#endregion\n}\n//#endregion\n\n//#region Events\nclass CheckBoxEvent\n{\n    sender: CheckBox;\n}\n\nexport class CheckBoxCheckEvent extends CheckBoxEvent\n{\n    stateEnum: CheckboxStateEnum;\n    checked: boolean;\n    shiftKey: boolean;\n    ctrlKey: boolean;\n}\n//#endregion"],"names":[],"mappings":"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"}