{"version":3,"file":"prompt.js","sources":["../../../../src/ui/controls/prompt.ts"],"sourcesContent":["import { createWindow, ButtonModeEnum, WindowFooterItemTypeEnum, createTextBox, puma } from \"../vr\";\nimport { Window } from \"./window\";\nimport { VrControlsEvent } from \"../common\";\nimport { TextBox, TextBoxOptions } from \"./textbox\";\nimport { Button } from \"./button\";\n\n//#region Options\nexport class PromptOptions {\n    textOkButton?: string;\n    textCancelButton?: string;\n    content?: string;\n    title?: string;\n    defaultValue?: string;\n    textboxSettings?: TextBoxOptions;\n    width?: number | string;\n    height?: number | string;\n    css?: string;\n    cssContainer?: string;\n\n    onContentLoaded?(e: ContentPromptLoadedEvent): void;\n}\n//#endregion\n\n//#region Control\nexport class Prompt {\n    private _window: Window;\n    private _options: PromptOptions;\n    private _textBox: TextBox;\n\n    constructor(text?: string | null, options?: PromptOptions | null) {\n        //#region Options\n        if (options == null)\n            options = new PromptOptions();\n\n        if (options.textOkButton == null) options.textOkButton = \"Conferma\";\n        if (options.textCancelButton == null) options.textCancelButton = \"Annulla\";\n        if (options.width == null) options.width = 300;\n        if (options.height == null) options.height = 120;\n        //#endregion\n\n        this._options = options;\n\n        //#region Content\n        let content = \"\";\n        if (options.content == null && text == null) options.content = \"<div></div>\";\n        if (options.content != null)\n            content = options.content;\n        else if (text != null)\n            content = text;\n        //#endregion\n\n        //#region TextBoxSettings\n        if (options.textboxSettings == null)\n            options.textboxSettings = new TextBoxOptions();\n\n        if (options.textboxSettings.width == null) options.textboxSettings.width = \"100%\";\n        if (options.textboxSettings.cssContainer == null) options.textboxSettings.cssContainer = \"margin-top: 5px;\";\n        if (options.textboxSettings.value == null) options.textboxSettings.value = options.defaultValue;\n        //#endregion\n\n        this._window = createWindow(\n            {\n                addToControlList: false,\n                closeable: false,\n                title: options.title,\n                width: options.width,\n                height: options.height,\n                removeOnClose: true,\n                content: \"<div class='contentContainer'>\" + content + \"</div>\",\n                cssContainer: \"height: auto !important;\",\n                css: \"height: auto !important;\",\n                footer:\n                    [\n                        { type: WindowFooterItemTypeEnum.Custom, text: options.textCancelButton, value: \"close\", cssContainer: \"width: Calc(50% - 5px);\", css: \"width: 100%;\", onClick: () => this.close() },\n                        { type: WindowFooterItemTypeEnum.Custom, text: options.textOkButton, value: \"ok\", cssContainer: \"width: Calc(50% - 5px);\", css: \"width: 100%;\", mode: ButtonModeEnum.Primary }\n                    ],\n                onContentLoaded: (e) => {\n                    let contentContainer = puma(e.sender.element()).find(\".contentContainer\")[0];\n                    this._textBox = createTextBox(options!.textboxSettings, contentContainer);\n                    window.setTimeout(() => this._textBox.focus());\n                    this.onContentLoaded(contentContainer);\n                }\n            });\n\n        if (options.cssContainer != null)\n            this._window.container().style.cssText += options.cssContainer + \";\";\n\n        if (options.css != null)\n            this._window.element().style.cssText += options.css + \";\";\n\n        puma(this._window.element()).addClass(\"vrPrompt\");\n        puma(this._window.container()).addClass(\"vrPromptContainer\");\n    }\n\n    open(): Promise<string> {\n        let promise = new Promise((okCallback?: (value: string) => void, cancelCallback?: Function) => {\n            this._window.open(\n                [\n                    {\n                        value: \"ok\", callback: () => {\n                            if (okCallback != null)\n                                okCallback(this._textBox.value());\n\n                            this.close();\n                        }\n                    },\n                    {\n                        value: \"close\", callback: () => {\n                            if (cancelCallback != null)\n                                cancelCallback();\n\n                            console.log();\n                        }\n                    }\n                ]\n            );\n            this._textBox.focus();\n        });\n        return promise;\n    }\n\n    close(): void {\n        this._window.close();\n        puma(this._window.container()).remove();\n        puma(this._window.background()).remove();\n    }\n\n    private getOptions(): PromptOptions {\n        return this._options;\n    }\n\n    private onContentLoaded(contentElement: HTMLElement): void {\n        let options = this.getOptions();\n        if (options.onContentLoaded != null) {\n            let contentLoadedEvent = new ContentPromptLoadedEvent();\n            contentLoadedEvent.sender = this;\n            contentLoadedEvent.contentElement = contentElement;\n            options.onContentLoaded(contentLoadedEvent);\n        }\n    }\n}\n//#endregion\n\n//#region Events\nclass ContentPromptLoadedEvent extends VrControlsEvent {\n    sender: Prompt;\n    contentElement: HTMLElement;\n}\n//#endregion"],"names":[],"mappings":"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"}