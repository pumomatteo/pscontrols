{"version":3,"file":"colorPicker.js","sources":["../../../../src/ui/controls/colorPicker.ts"],"sourcesContent":["import { ColorPickerManager } from \"../../../src/managers/colorPickerManager\";\nimport { VrControl, VrControlOptions, VrControlsEvent } from \"../common\";\nimport { ColorPickerModeEnum, ColorPickerRgbaValue, ControlTypeEnum, createIcon, div, IconClassicLight, IconClass, puma, IconClassicSolid } from \"../vr\";\n\ndeclare var JSColor: any;\n\n//#region Options\nexport class ColorPickerOptions extends VrControlOptions\n{\n\tshowInput?: boolean;\n\tmode?: ColorPickerModeEnum;\n\tpalette?: boolean | string[];\n\tcloseButton?: boolean | string;\n\talphaChannel?: boolean;\n\tvalue?: string | ColorPickerRgbaValue;\n\thexUppercase?: boolean;\n\tclearButton?: boolean;\n\thideOnPaletteClick?: boolean;\n\temptyMessage?: string;\n\n\tonChange?: (e: ColorPickerChangeEvent) => void;\n}\n//#endregion\n\n//#region Control\nexport class ColorPicker extends VrControl\n{\n\t//#region Variables\n\tprivate _picker: any;\n\tprivate _value: string | null;\n\t//#endregion\n\n\tconstructor(element: HTMLElement, options?: ColorPickerOptions | null)\n\t{\n\t\t//#region Options\n\t\tif (options == null)\n\t\t\toptions = new ColorPickerOptions();\n\n\t\tif (options.addToControlList == null) options.addToControlList = false;\n\t\tif (options.showInput == null) options.showInput = true;\n\t\tif (options.mode == null) options.mode = ColorPickerModeEnum.Hex;\n\t\tif (options.alphaChannel == null) options.alphaChannel = true;\n\t\tif (options.hexUppercase == null) options.hexUppercase = true;\n\t\tif (options.clearButton == null) options.clearButton = true;\n\t\tif (options.hideOnPaletteClick == null) options.hideOnPaletteClick = false;\n\t\tif (options.emptyMessage == null) options.emptyMessage = \"Scegli...\";\n\n\t\tif (options.closeButton == null) options.closeButton = false;\n\t\tif (options.closeButton === true) options.closeButton = \"Chiudi\";\n\n\t\tif (options.palette == null) options.palette = true;\n\t\tif (options.palette === true)\n\t\t\toptions.palette = [\"#fff\", \"#ffffff\", \"#808080\", \"#000\", \"#996e36\", \"#ff0000\", \"#ffe438\", \"#88dd20\", \"#51B3E1\", \"#e3f1fa\", \"#bb1cd4\"];\n\t\t//#endregion\n\n\t\tsuper(element, options, ControlTypeEnum.ColorPicker);\n\t\ttry { new ColorPickerManager(); } catch (e) { } // To include js\n\n\t\tthis._picker = new JSColor(element, { format: options.mode });\n\t\tthis._value = null;\n\n\t\t//#region JsColor options\n\t\tthis._picker.option({\n\t\t\tshadow: false,\n\t\t\tpalette: (options.palette !== false) ? options.palette : undefined,\n\t\t\tpaletteCols: (options.palette !== false) ? options.palette.length : undefined,\n\t\t\tpaletteSetsAlpha: true,\n\t\t\thideOnPaletteClick: options.hideOnPaletteClick,\n\t\t\tcloseButton: (options.closeButton !== false),\n\t\t\tcloseText: (options.closeButton !== false) ? options.closeButton : undefined,\n\t\t\talphaChannel: options.alphaChannel,\n\t\t\trequired: true,\n\t\t\tuppercase: options.hexUppercase,\n\t\t\tonChange: () => \n\t\t\t{\n\t\t\t\tthis._value = (this.mode() == ColorPickerModeEnum.Hex) ? this.valueHex() : this.valueRgba();\n\t\t\t\tthis.triggerChange();\n\t\t\t}\n\t\t});\n\t\t//#endregion\n\n\t\t//#region Width & Height\n\t\tthis.element().style.cssText += \"height: \" + ((options.showInput) ? 23 : 27) + \"px;\";\n\t\t//#endregion\n\n\t\t//#region Input\n\t\tif (options.showInput)\n\t\t{\n\t\t\tlet minWidth = (options.mode == ColorPickerModeEnum.Hex) ? 60 : 120;\n\t\t\tthis.element().style.cssText += \"width: \" + minWidth + \"px; min-width: \" + minWidth + \"px !important;\";\n\t\t}\n\t\telse\n\t\t\tthis.element().style.cssText += \"width: 27px; min-width: unset !important; background-image: unset !important; position: relative;\";\n\t\t//#endregion\n\n\t\t//#region Value\n\t\tthis.clear();\n\n\t\tif (options.value != null)\n\t\t\tthis.value(options.value);\n\t\t//#endregion\n\n\t\t//#region Open elements\n\t\tif (!options.showInput)\n\t\t{\n\t\t\tlet divOpen = div(this.element(), { class: \"vrColorPickerDivOpen\", css: \"position: absolute; cursor: pointer; text-align: center; bottom: 0px; left: 0px; height: 5px; background-color: rgba(0, 0, 0, 0.2); width: 24px; border-bottom-left-radius: 4px; border-bottom-right-radius: 4px; border: solid 1px #CCC; border-top: none;\" })\n\t\t\tcreateIcon({\n\t\t\t\tvalue: IconClassicLight.CaretUp,\n\t\t\t\tcolor: \"rgba(255, 255, 255, 0.8)\",\n\t\t\t\twidth: \"100%\",\n\t\t\t\tfontSize: 12,\n\t\t\t\tcursorPointer: true,\n\t\t\t\tcssContainer: \"top: -4px;\"\n\t\t\t}, divOpen);\n\n\t\t\tpuma(divOpen).on(\"click\", (e: JQuery.ClickEvent) => this.open());\n\t\t}\n\t\t//#endregion\n\n\t\t//#region Clear icon\n\t\tif (options.clearButton)\n\t\t{\n\t\t\tlet clearIcon = createIcon({\n\t\t\t\tid: element.id + \"_someStuff\",\n\t\t\t\tcssContainer: \"cursor: pointer; position: absolute; left: 24px; bottom: 17px; background-color: #FFF; border-radius: 10px; border: solid 1px #51B3E1; padding: 1px; font-size: 13px; padding-left: 2px; padding-right: 2px;\",\n\t\t\t\tcss: \"color: #51B3E1 !important;\",\n\t\t\t\tvalue: IconClassicLight.Delete,\n\t\t\t\tonClick: (e) => this.clear(true)\n\t\t\t}, this.container(), null, this.element().id + \"_vrColorPickerClearIcon\");\n\t\t}\n\t\t//#endregion\n\t}\n\n\t//#region Methods\n\tvalue(value?: string | ColorPickerRgbaValue, triggerChange = true)\n\t{\n\t\tif (value != null && value != \"\")\n\t\t{\n\t\t\tif (typeof (value) == \"string\")\n\t\t\t\tthis.valueHex(value, triggerChange);\n\t\t\telse\n\t\t\t\tthis.valueRgba(value, triggerChange);\n\t\t}\n\t\treturn this._value;\n\t}\n\n\tvalueHex(value?: string, triggerChange = true)\n\t{\n\t\tif (value != null)\n\t\t{\n\t\t\tthis._picker.fromString(value);\n\t\t\tthis._value = this._picker.toHEXString();\n\n\t\t\tif (triggerChange)\n\t\t\t\tthis.triggerChange();\n\t\t}\n\t\treturn this._picker.toHEXString();\n\t}\n\n\tvalueRgba(value?: ColorPickerRgbaValue, triggerChange = true)\n\t{\n\t\tif (value != null)\n\t\t{\n\t\t\tthis._picker.fromRGBA(value.r, value.g, value.b, (value.a != null) ? value.a : 1);\n\t\t\tthis._value = this._picker.toRGBAString();\n\n\t\t\tif (triggerChange)\n\t\t\t\tthis.triggerChange();\n\t\t}\n\t\treturn this._picker.toRGBAString();\n\t}\n\n\trandomize(triggerChange = true)\n\t{\n\t\tthis._picker.randomize();\n\t\tthis._value = this.valueHex();\n\n\t\tif (triggerChange)\n\t\t\tthis.triggerChange();\n\n\t\treturn this.value();\n\t}\n\n\topen()\n\t{\n\t\tthis._picker.show();\n\t}\n\n\tclose()\n\t{\n\t\tthis._picker.hide();\n\t}\n\n\tmode()\n\t{\n\t\treturn this.getOptions().mode!;\n\t}\n\n\ttriggerChange()\n\t{\n\t\tlet options = this.getOptions();\n\n\t\t//#region Change event\n\t\tif (options!.onChange != null)\n\t\t{\n\t\t\tlet event = new ColorPickerChangeEvent();\n\t\t\tevent.sender = this;\n\t\t\tevent.value = this.value();\n\t\t\tevent.valueHex = this.valueHex();\n\t\t\tevent.valueRgba = this.valueRgba();\n\t\t\toptions!.onChange(event);\n\t\t}\n\t\t//#endregion\n\t}\n\n\tclear(triggerChange = false)\n\t{\n\t\tlet options = this.getOptions();\n\t\tthis._value = null;\n\n\t\tthis.element().style.cssText += \"background-image: unset;\";\n\t\tthis.element().style.cssText += \"background: url('data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/wAALCAAoACgBAREA/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEG/8QAKRAAAgECBQMDBQEAAAAAAAAAAREAIWESMUFRUjJCcYGhwQJigqLC0f/aAAgBAQAAPwDbVZJIJOZGX1DYXgaKhHST2+Yokim1q9/Ebur6l3eJasFgEBA6AbG8LRIiuHjeT3eQ53i+KmWL4jfRZ/ZCqkya4eV4CQTTo83e0bvLuXxLV6Nei/2QaL8X8xRFtOqzdrRdt0xcrR6pa8LRbDfD/Ue7/eL4kqYuNpassAECoGQG4vINFUnpfd5iizKeer28Ru6LqXb4lqwAA1QaEbm8/9k=') no-repeat !important;\";\n\n\t\tif (options.showInput)\n\t\t{\n\t\t\t(this.element() as HTMLInputElement).value = \"\";\n\t\t\t(this.element() as HTMLInputElement).placeholder = options.emptyMessage!;\n\t\t\tthis.element().style.cssText += \"background-size: 30px 30px !important;\";\n\t\t}\n\t\t// else\n\t\t// \tthis.element().style.cssText += \"background-size: 40px 40px !important;\";\n\n\t\tif (triggerChange)\n\t\t\tthis.triggerChange();\n\t}\n\n\t//#region Overrides\n\tenable(): void\n\t{\n\t\tsuper.enable();\n\t\twindow.setTimeout(() =>\n\t\t{\n\t\t\tlet options = this.getOptions();\n\t\t\tif (!options.showInput)\n\t\t\t{\n\t\t\t\tthis._picker.option(\"showOnClick\", true);\n\t\t\t\tpuma(this.container()).find(\".vrColorPickerDivOpen\").show();\n\t\t\t}\n\t\t\telse\n\t\t\t\tpuma(this.element()).removeAttr(\"disabled\");\n\t\t});\n\t}\n\n\tdisable(): void\n\t{\n\t\tsuper.disable();\n\t\twindow.setTimeout(() => \n\t\t{\n\t\t\tlet options = this.getOptions();\n\t\t\tif (!options.showInput)\n\t\t\t{\n\t\t\t\tthis._picker.option(\"showOnClick\", false);\n\t\t\t\tpuma(this.container()).find(\".vrColorPickerDivOpen\").hide();\n\t\t\t}\n\t\t\telse\n\t\t\t\tpuma(this.element()).attr(\"disabled\", \"disabled\");\n\t\t});\n\t}\n\t//#endregion\n\n\tgetOptions()\n\t{\n\t\treturn this.options<ColorPickerOptions>();\n\t}\n\t//#endregion\n}\n\n//#region Classes\nclass ColorPickerEvent extends VrControlsEvent\n{\n\tsender: ColorPicker;\n}\n\nclass ColorPickerChangeEvent extends ColorPickerEvent\n{\n\tvalue: string | null;\n\tvalueHex: string;\n\tvalueRgba: string;\n}\n//#endregion"],"names":[],"mappings":"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"}