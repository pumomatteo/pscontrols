{"version":3,"file":"printManager.js","sources":["../../../src/managers/printManager.ts"],"sourcesContent":["import { puma } from \"../../src/ui/vr\";\n\ndeclare function printJS(options: PrintJsOptions): void;\n// https://printjs.crabbly.com/\n\nexport class PrintManager\n{\n\t//#region Print bytes, pdf, image or html\n\tpublic static printBytes(base64Bytes: string, options?: PrintFileOptions)\n\t{\n\t\tthis.printBytesFileImageOrHtml(base64Bytes, PrintTypeEnum.Pdf, options, true);\n\t}\n\n\tpublic static printPdf(path: string, options?: PrintFileOptions)\n\t{\n\t\tthis.printBytesFileImageOrHtml(path, PrintTypeEnum.Pdf, options);\n\t}\n\n\tpublic static printImage(path: string, options?: PrintFileOptions)\n\t{\n\t\tthis.printBytesFileImageOrHtml(path, PrintTypeEnum.Image, options);\n\t}\n\n\tpublic static printHtml(elementId: string, options?: PrintFileOptions)\n\t{\n\t\tif (elementId.startsWith(\"#\"))\n\t\t\telementId = elementId.substr(1);\n\n\t\tthis.printBytesFileImageOrHtml(elementId, PrintJsTypeEnum.Html, options);\n\t}\n\n\tpublic static printElement(element: string | HTMLElement | JQuery, options?: PrintHtmlOptions)\n\t{\n\t\tlet elementId = \"\";\n\t\tif (typeof (element) != \"string\")\n\t\t\telementId = puma(element)[0].id;\n\n\t\tif (elementId == \"\" || elementId == null)\n\t\t{\n\t\t\tpuma(element)[0].id = \"vr_printTemp\";\n\t\t\telementId = \"vr_printTemp\";\n\t\t}\n\n\t\tif (!elementId.startsWith(\"#\"))\n\t\t\telementId = \"#\" + elementId;\n\n\t\tif (options == null) options = new PrintHtmlOptions();\n\t\tpuma(elementId).printThis({\n\t\t\tpageTitle: options.pageTitle,\n\t\t\tremoveInlineStyles: options.removeInlineStyles,\n\t\t\tprintDelay: options.printDelay,\n\t\t\theader: options.header,\n\t\t\tfooter: options.footer,\n\t\t\tremoveScripts: options.removeScripts,\n\t\t\tdebug: options.debug,\n\t\t\tbeforePrint: options.beforePrint,\n\t\t\timportCSS: true,\n\t\t\timportStyle: true,\n\t\t\tafterPrint: () =>\n\t\t\t{\n\t\t\t\tif (elementId == \"#vr_printTemp\")\n\t\t\t\t\tpuma(element)[0].id = \"\";\n\n\t\t\t\tif (options!.afterPrint != null)\n\t\t\t\t\toptions!.afterPrint();\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate static printBytesFileImageOrHtml(pathBytesOrId: string, type: PrintTypeEnum | string, options?: PrintFileOptions,\n\t\tbase64: boolean = false, showModal = true)\n\t{\n\t\tif (pathBytesOrId == \"\")\n\t\t\treturn;\n\n\t\tlet title = undefined;\n\t\tlet documentTitle = \"File_\" + new Date().toLocaleString();\n\t\tlet customCss = undefined;\n\t\tif (options != null)\n\t\t{\n\t\t\tif (options.type != null) type = options.type;\n\t\t\tif (options.headerTitle != null) title = options.headerTitle;\n\t\t\tif (options.documentTitle != null) documentTitle = options.documentTitle;\n\t\t\tif (options.customCss != null) customCss = options.customCss;\n\t\t}\n\n\t\tlet printJsOptions = new PrintJsOptions();\n\t\tprintJsOptions.printable = pathBytesOrId;\n\t\tprintJsOptions.type = type;\n\t\tprintJsOptions.base64 = base64;\n\t\tprintJsOptions.header = title;\n\t\tprintJsOptions.documentTitle = documentTitle;\n\t\tprintJsOptions.style = customCss;\n\t\tprintJsOptions.showModal = showModal;\n\t\tprintJsOptions.modalMessage = \"Attendi file...\";\n\t\tthis.print(printJsOptions);\n\t}\n\t//#endregion\n\n\t//#region Print grid\n\tpublic static printGrid(jsonData: any, options?: PrintGridOptions)\n\t{\n\t\tif (jsonData == null)\n\t\t\treturn;\n\n\t\tlet headerCss = undefined;\n\t\tlet contentCss = undefined;\n\t\tlet properties: string[] | null = null;\n\t\tlet title = undefined;\n\t\tlet repeatHeaderOnEveryPage = true;\n\t\tlet documentTitle = \"File_\" + new Date().toLocaleString();\n\t\tif (options != null)\n\t\t{\n\t\t\tif (options.headerCss != null) headerCss = options.headerCss;\n\t\t\tif (options.contentCss != null) contentCss = options.contentCss;\n\t\t\tif (options.properties != null) properties = options.properties;\n\t\t\tif (options.headerTitle != null) title = options.headerTitle;\n\t\t\tif (options.repeatHeaderOnEveryPages != null) repeatHeaderOnEveryPage = options.repeatHeaderOnEveryPages;\n\t\t\tif (options.documentTitle != null) documentTitle = options.documentTitle;\n\t\t}\n\n\t\tlet printJsOptions = new PrintJsOptions();\n\t\tprintJsOptions.printable = jsonData;\n\t\tprintJsOptions.type = PrintJsTypeEnum.Json;\n\t\tprintJsOptions.properties = (properties == null) ? Object.getOwnPropertyNames(jsonData) : properties;\n\t\tprintJsOptions.gridHeaderStyle = headerCss;\n\t\tprintJsOptions.gridStyle = contentCss;\n\t\tprintJsOptions.header = title;\n\t\tprintJsOptions.repeatTableHeader = repeatHeaderOnEveryPage;\n\t\tprintJsOptions.documentTitle = documentTitle;\n\t\tthis.print(printJsOptions);\n\t}\n\t//#endregion\n\n\tprivate static print(options: PrintJsOptions)\n\t{\n\t\tprintJS(options);\n\t}\n}\n\n//#region Classes\nclass PrintJsOptions\n{\n\tpublic printable: string | string[];\n\tpublic type?: string;\n\tpublic base64?: boolean;\n\tpublic properties?: string[];\n\tpublic gridHeaderStyle?: string;\n\tpublic gridStyle?: string;\n\tpublic header?: string;\n\tpublic repeatTableHeader?: boolean;\n\tpublic documentTitle?: string;\n\tpublic style?: string;\n\tshowModal?: boolean;\n\tmodalMessage?: string;\n}\n\nenum PrintJsTypeEnum\n{\n\tPdf = \"pdf\",\n\tHtml = \"html\",\n\tImage = \"image\",\n\tJson = \"json\"\n}\n\nexport enum PrintTypeEnum\n{\n\tPdf = \"pdf\",\n\tImage = \"image\"\n}\n\nexport class PrintFileOptions\n{\n\tpublic type?: PrintTypeEnum;\n\tpublic loadingMessage?: string;\n\tpublic headerTitle?: string;\n\tpublic documentTitle?: string;\n\tpublic customCss?: string;\n}\n\nexport class PrintHtmlOptions\n{\n\tpageTitle?: string;\n\tremoveInlineStyles?: boolean;\n\tprintDelay?: number;\n\theader?: string | HTMLElement | JQuery;\n\tfooter?: string | HTMLElement | JQuery;\n\tremoveScripts?: boolean;\n\tdebug?: boolean;\n\n\tbeforePrint?: Function;\n\tafterPrint?: Function;\n}\n\nclass PrintGridOptions\n{\n\tpublic headerCss?: string;\n\tpublic contentCss?: string;\n\tpublic properties?: string[];\n\tpublic loadingMessage?: string;\n\tpublic headerTitle?: string;\n\tpublic repeatHeaderOnEveryPages?: boolean;\n\tpublic documentTitle?: string;\n}\n//#endregion\n\n//#region PrintThis\n(function ($)\n{\n\n\tfunction appendContent($el: any, content: any)\n\t{\n\t\tif (!content) return;\n\n\t\t// Simple test for a jQuery element\n\t\t$el.append(content.jquery ? content.clone() : content);\n\t}\n\n\tfunction appendBody($body: any, $element: any, opt: any)\n\t{\n\t\t// Clone for safety and convenience\n\t\t// Calls clone(withDataAndEvents = true) to copy form values.\n\t\tvar $content = $element.clone(opt.formValues);\n\n\t\tif (opt.formValues)\n\t\t{\n\t\t\t// Copy original select and textarea values to their cloned counterpart\n\t\t\t// Makes up for inability to clone select and textarea values with clone(true)\n\t\t\tcopyValues($element, $content, 'select, textarea');\n\t\t}\n\n\t\tif (opt.removeScripts)\n\t\t{\n\t\t\t$content.find('script').remove();\n\t\t}\n\n\t\tif (opt.printContainer)\n\t\t{\n\t\t\t// grab $.selector as container\n\t\t\t$content.appendTo($body);\n\t\t} else\n\t\t{\n\t\t\t// otherwise just print interior elements of container\n\t\t\t$content.each(function (index: number, element: any)\n\t\t\t{\n\t\t\t\t$(element).children().appendTo($body)\n\t\t\t});\n\t\t}\n\t}\n\n\t// Copies values from origin to clone for passed in elementSelector\n\tfunction copyValues(origin: any, clone: any, elementSelector: any)\n\t{\n\t\tvar $originalElements = origin.find(elementSelector);\n\n\t\tclone.find(elementSelector).each(function (index: any, item: any)\n\t\t{\n\t\t\t$(item).val($originalElements.eq(index).val());\n\t\t});\n\t}\n\n\tvar opt: any;\n\t($.fn as any).printThis = function (options: any)\n\t{\n\t\topt = $.extend({}, ($.fn as any).printThis.defaults, options);\n\t\tvar $element = this instanceof jQuery ? this : $(this);\n\n\t\tvar strFrameName = \"printThis-\" + (new Date()).getTime();\n\n\t\tif (window.location.hostname !== document.domain && navigator.userAgent.match(/msie/i))\n\t\t{\n\t\t\t// Ugly IE hacks due to IE not inheriting document.domain from parent\n\t\t\t// checks if document.domain is set by comparing the host name against document.domain\n\t\t\tvar iframeSrc = \"javascript:document.write(\\\"<head><script>document.domain=\\\\\\\"\" + document.domain + \"\\\\\\\";</s\" + \"cript></head><body></body>\\\")\";\n\t\t\tvar printI = document.createElement('iframe');\n\t\t\tprintI.name = \"printIframe\";\n\t\t\tprintI.id = strFrameName;\n\t\t\tprintI.className = \"MSIE\";\n\t\t\tdocument.body.appendChild(printI);\n\t\t\tprintI.src = iframeSrc;\n\n\t\t} else\n\t\t{\n\t\t\t// other browsers inherit document.domain, and IE works if document.domain is not explicitly set\n\t\t\tvar $frame = $(\"<iframe id='\" + strFrameName + \"' name='printIframe' />\");\n\t\t\t$frame.appendTo(\"body\");\n\t\t}\n\n\t\tvar $iframe = $(\"#\" + strFrameName);\n\n\t\t// show frame if in debug mode\n\t\tif (!opt.debug) $iframe.css({\n\t\t\tposition: \"absolute\",\n\t\t\twidth: \"0px\",\n\t\t\theight: \"0px\",\n\t\t\tleft: \"-600px\",\n\t\t\ttop: \"-600px\"\n\t\t});\n\n\t\t// before print callback\n\t\tif (typeof opt.beforePrint === \"function\")\n\t\t{\n\t\t\topt.beforePrint();\n\t\t}\n\n\t\t// $iframe.ready() and $iframe.load were inconsistent between browsers\n\t\tsetTimeout(function ()\n\t\t{\n\n\t\t\t// Add doctype to fix the style difference between printing and render\n\t\t\tfunction setDocType($iframe: any, doctype: any)\n\t\t\t{\n\t\t\t\tvar win, doc;\n\t\t\t\twin = $iframe.get(0);\n\t\t\t\twin = win.contentWindow || win.contentDocument || win;\n\t\t\t\tdoc = win.document || win.contentDocument || win;\n\t\t\t\tdoc.open();\n\t\t\t\tdoc.write(doctype);\n\t\t\t\tdoc.close();\n\t\t\t}\n\n\t\t\tif (opt.doctypeString)\n\t\t\t{\n\t\t\t\tsetDocType($iframe, opt.doctypeString);\n\t\t\t}\n\n\t\t\tvar $doc = $iframe.contents(),\n\t\t\t\t$head = $doc.find(\"head\"),\n\t\t\t\t$body = $doc.find(\"body\"),\n\t\t\t\t$base = $('base'),\n\t\t\t\tbaseURL;\n\n\t\t\t// add base tag to ensure elements use the parent domain\n\t\t\tif (opt.base === true && $base.length > 0)\n\t\t\t{\n\t\t\t\t// take the base tag from the original page\n\t\t\t\tbaseURL = $base.attr('href');\n\t\t\t} else if (typeof opt.base === 'string')\n\t\t\t{\n\t\t\t\t// An exact base string is provided\n\t\t\t\tbaseURL = opt.base;\n\t\t\t} else\n\t\t\t{\n\t\t\t\t// Use the page URL as the base\n\t\t\t\tbaseURL = document.location.protocol + '//' + document.location.host;\n\t\t\t}\n\n\t\t\t$head.append('<base href=\"' + baseURL + '\">');\n\n\t\t\t// import page stylesheets\n\t\t\tif (opt.importCSS) $(\"link[rel=stylesheet]\").each(function (index: number, element: any)\n\t\t\t{\n\t\t\t\tvar href = $(element).attr(\"href\");\n\t\t\t\tif (href)\n\t\t\t\t{\n\t\t\t\t\tvar media = $(element).attr(\"media\") || \"all\";\n\t\t\t\t\t$head.append(\"<link type='text/css' rel='stylesheet' href='\" + href + \"' media='\" + media + \"'>\");\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// import style tags\n\t\t\tif (opt.importStyle) $(\"style\").each(function (index: number, element: any)\n\t\t\t{\n\t\t\t\t$head.append(element.outerHTML);\n\t\t\t});\n\n\t\t\t// add title of the page\n\t\t\tif (opt.pageTitle) $head.append(\"<title>\" + opt.pageTitle + \"</title>\");\n\n\t\t\t// import additional stylesheet(s)\n\t\t\tif (opt.loadCSS)\n\t\t\t{\n\t\t\t\tif ($.isArray(opt.loadCSS))\n\t\t\t\t{\n\t\t\t\t\tjQuery.each(opt.loadCSS, function (index: any, value: any)\n\t\t\t\t\t{\n\t\t\t\t\t\t$head.append(\"<link type='text/css' rel='stylesheet' href='\" + value + \"'>\");\n\t\t\t\t\t});\n\t\t\t\t} else\n\t\t\t\t{\n\t\t\t\t\t$head.append(\"<link type='text/css' rel='stylesheet' href='\" + opt.loadCSS + \"'>\");\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar pageHtml = $('html')[0];\n\n\t\t\t// CSS VAR in html tag when dynamic apply e.g.  document.documentElement.style.setProperty(\"--foo\", bar);\n\t\t\t$doc.find('html').prop('style', pageHtml.style.cssText);\n\n\t\t\t// copy 'root' tag classes\n\t\t\tvar tag = opt.copyTagClasses;\n\t\t\tif (tag)\n\t\t\t{\n\t\t\t\ttag = tag === true ? 'bh' : tag;\n\t\t\t\tif (tag.indexOf('b') !== -1)\n\t\t\t\t{\n\t\t\t\t\t$body.addClass($('body')[0].className);\n\t\t\t\t}\n\t\t\t\tif (tag.indexOf('h') !== -1)\n\t\t\t\t{\n\t\t\t\t\t$doc.find('html').addClass(pageHtml.className);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// print header\n\t\t\tappendContent($body, opt.header);\n\n\t\t\tif (opt.canvas)\n\t\t\t{\n\t\t\t\t// add canvas data-ids for easy access after cloning.\n\t\t\t\tvar canvasId = 0;\n\t\t\t\t// .addBack('canvas') adds the top-level element if it is a canvas.\n\t\t\t\t($element as any).find('canvas').addBack('canvas').each(function (index: number, element: any)\n\t\t\t\t{\n\t\t\t\t\t$(element).attr('data-printthis', canvasId++);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tappendBody($body, $element, opt);\n\n\t\t\tif (opt.canvas)\n\t\t\t{\n\t\t\t\t// Re-draw new canvases by referencing the originals\n\t\t\t\t$body.find('canvas').each(function (index: number, element: any)\n\t\t\t\t{\n\t\t\t\t\tvar cid = $(element).data('printthis'),\n\t\t\t\t\t\t$src = $('[data-printthis=\"' + cid + '\"]');\n\n\t\t\t\t\telement.getContext('2d').drawImage($src[0], 0, 0);\n\n\t\t\t\t\t// Remove the markup from the original\n\t\t\t\t\tif ($.isFunction($.fn.removeAttr))\n\t\t\t\t\t{\n\t\t\t\t\t\t$src.removeAttr('data-printthis');\n\t\t\t\t\t} else\n\t\t\t\t\t{\n\t\t\t\t\t\t$.each($src, function (i: any, el: any)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tel.removeAttribute('data-printthis');\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// remove inline styles\n\t\t\tif (opt.removeInline)\n\t\t\t{\n\t\t\t\t// Ensure there is a selector, even if it's been mistakenly removed\n\t\t\t\tvar selector = opt.removeInlineSelector || '*';\n\t\t\t\t// $.removeAttr available jQuery 1.7+\n\t\t\t\tif ($.isFunction(($ as any).removeAttr))\n\t\t\t\t{\n\t\t\t\t\t$body.find(selector).removeAttr(\"style\");\n\t\t\t\t} else\n\t\t\t\t{\n\t\t\t\t\t$body.find(selector).attr(\"style\", \"\");\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// print \"footer\"\n\t\t\tappendContent($body, opt.footer);\n\n\t\t\t// attach event handler function to beforePrint event\n\t\t\tfunction attachOnBeforePrintEvent($iframe: any, beforePrintHandler: any)\n\t\t\t{\n\t\t\t\tvar win = $iframe.get(0);\n\t\t\t\twin = win.contentWindow || win.contentDocument || win;\n\n\t\t\t\tif (typeof beforePrintHandler === \"function\")\n\t\t\t\t{\n\t\t\t\t\tif ('matchMedia' in win)\n\t\t\t\t\t{\n\t\t\t\t\t\twin.matchMedia('print').addListener(function (mql: any)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (mql.matches) beforePrintHandler();\n\t\t\t\t\t\t});\n\t\t\t\t\t} else\n\t\t\t\t\t{\n\t\t\t\t\t\twin.onbeforeprint = beforePrintHandler;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tattachOnBeforePrintEvent($iframe, opt.beforePrintEvent);\n\n\t\t\tsetTimeout(function ()\n\t\t\t{\n\t\t\t\tif ($iframe.hasClass(\"MSIE\"))\n\t\t\t\t{\n\t\t\t\t\t// check if the iframe was created with the ugly hack\n\t\t\t\t\t// and perform another ugly hack out of neccessity\n\t\t\t\t\t(window.frames as any)[\"printIframe\"].focus();\n\t\t\t\t\t$head.append(\"<script>  window.print(); </s\" + \"cript>\");\n\t\t\t\t} else\n\t\t\t\t{\n\t\t\t\t\t// proper method\n\t\t\t\t\tif (document.queryCommandSupported(\"print\"))\n\t\t\t\t\t{\n\t\t\t\t\t\t($iframe[0] as any).contentWindow.document.execCommand(\"print\", false, null);\n\t\t\t\t\t} else\n\t\t\t\t\t{\n\t\t\t\t\t\t($iframe[0] as any).contentWindow.focus();\n\t\t\t\t\t\t($iframe[0] as any).contentWindow.print();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// remove iframe after print\n\t\t\t\tif (!opt.debug)\n\t\t\t\t{\n\t\t\t\t\tsetTimeout(function ()\n\t\t\t\t\t{\n\t\t\t\t\t\t$iframe.remove();\n\n\t\t\t\t\t}, 1000);\n\t\t\t\t}\n\n\t\t\t\t// after print callback\n\t\t\t\tif (typeof opt.afterPrint === \"function\")\n\t\t\t\t{\n\t\t\t\t\topt.afterPrint();\n\t\t\t\t}\n\n\t\t\t}, opt.printDelay);\n\n\t\t}, 333);\n\n\t};\n\n\t// defaults\n\t($.fn as any).printThis.defaults = {\n\t\tdebug: false,               // show the iframe for debugging\n\t\timportCSS: true,            // import parent page css\n\t\timportStyle: false,         // import style tags\n\t\tprintContainer: true,       // print outer container/$.selector\n\t\tloadCSS: \"\",                // path to additional css file - use an array [] for multiple\n\t\tpageTitle: \"\",              // add title to print page\n\t\tremoveInline: false,        // remove inline styles from print elements\n\t\tremoveInlineSelector: \"*\",  // custom selectors to filter inline styles. removeInline must be true\n\t\tprintDelay: 333,            // variable print delay\n\t\theader: null,               // prefix to html\n\t\tfooter: null,               // postfix to html\n\t\tbase: false,                // preserve the BASE tag or accept a string for the URL\n\t\tformValues: true,           // preserve input/form values\n\t\tcanvas: false,              // copy canvas content\n\t\tdoctypeString: '<!DOCTYPE html>', // enter a different doctype for older markup\n\t\tremoveScripts: false,       // remove script tags from print content\n\t\tcopyTagClasses: false,      // copy classes from the html & body tag\n\t\tbeforePrintEvent: null,     // callback function for printEvent in iframe\n\t\tbeforePrint: null,          // function called before iframe is filled\n\t\tafterPrint: null            // function called before iframe is removed\n\t};\n})(jQuery);\n//#endregion"],"names":["opt","$iframe"],"mappings":"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"}